namespace = wasteland_blocker

wasteland_blocker.0001 = { # Clearing out the Wolves
	type = character_event
	title = wasteland_blocker.0001.t
	desc = wasteland_blocker.0001.desc
	theme = hunting

	left_portrait = {
		character = root
		animation = personality_bold
	}
	
	right_portrait = {
		character = scope:knight
		animation = war_defender
	}
	
	lower_center_portrait = {
		character = scope:hooked_character
	}

	immediate = {
		if = {
			limit = { 
				any_knight = { 
					is_ai = yes
					count > 0
				}
			}
			ordered_knight = {
				limit = { is_ai = yes }
				order_by = prowess
				save_scope_as = knight
			}
		}
		if = {
			limit = { 
				any_hooked_character = { 
					is_ai = yes
					count > 0
				}
			}
			ordered_hooked_character = {
				limit = { is_ai = yes }
				order_by = prowess
				save_scope_as = hooked_character
			}
		}
	}

	option = { # Take them on myself
		name = wasteland_blocker.0001.a
		duel = {
			skill = prowess 
			value = 25
			50 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
					min = -50
				}
				desc = wasteland_blocker.0001.a.duel_success
				send_interface_toast = {
					left_icon = root
					add_prestige = 100
					title = wasteland_blocker.0001.success.toast.t
					scope:obstacle_province = { remove_building = wolf_den_cleared }
				}
			}
			50 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -1
					min = -50
				}
				desc = wasteland_blocker.0001.a.duel_failure
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0001.failure.toast.t
					add_prestige = -150
					increase_wounds_effect = { REASON = hunting_accident }
					hidden_effect = { scope:obstacle_province = { remove_building = wolf_den_cleared } }
					scope:obstacle_province = { add_building = wolf_den }
				}
			}
		}
	}
	
	option = { # Send a skilled knight
		name = wasteland_blocker.0001.b
		trigger = { 
			any_knight = { 
				is_ai = yes
				count > 0
			} 
		}
		scope:knight = {
			duel = {
				skill = prowess 
				value = 25
				50 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 1
						min = -50
					}
					desc = wasteland_blocker.0001.b.duel_success
					root = {
						send_interface_toast = {
							left_icon = root
							right_icon = scope:knight
							scope:knight = { add_prestige = 100 }
							title = wasteland_blocker.0001.success.toast.t
							scope:obstacle_province = { remove_building = wolf_den_cleared }
						}
					}
				}
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -1
						min = -50
					}
					desc = wasteland_blocker.0001.b.duel_failure
					root = {
						send_interface_toast = {
							left_icon = root
							right_icon = scope:knight
							title = wasteland_blocker.0001.failure.toast.t
							scope:knight = { add_prestige = -150 }
							increase_wounds_effect = { REASON = hunting_accident }
							hidden_effect = { scope:obstacle_province = { remove_building = wolf_den_cleared } }
							scope:obstacle_province = { add_building = wolf_den }
						}
					}
				}
			}
		}
	}
	
	option = { # Send a hooked character
		name = wasteland_blocker.0001.c
		trigger = { 
			any_hooked_character = { 
				is_ai = yes
				count > 0
			}
		}
		use_hook = scope:hooked_character
		scope:hooked_character = {
			duel = {
				skill = prowess 
				value = 25
				50 = { 
					compare_modifier = {
						value = scope:duel_value
						multiplier = 1
						min = -50
					}
					desc = wasteland_blocker.0001.c.duel_success
					root = {
						send_interface_toast = {
							left_icon = root
							right_icon = scope:hooked_character
							scope:hooked_character = { add_prestige = 100 }
							title = wasteland_blocker.0001.success.toast.t
							scope:obstacle_province = { remove_building = wolf_den_cleared }
						}
					}
				}
				50 = {
					compare_modifier = {
						value = scope:duel_value
						multiplier = -1
						min = -50
					}
					desc = wasteland_blocker.0001.c.duel_failure
					root = {
						send_interface_toast = {
							left_icon = root
							right_icon = scope:hooked_character
							title = wasteland_blocker.0001.failure.toast.t
							scope:hooked_character = { add_prestige = -150 }
							increase_wounds_effect = { REASON = hunting_accident }
							hidden_effect = { scope:obstacle_province = { remove_building = wolf_den_cleared } }
							scope:obstacle_province = { add_building = wolf_den }
						}
					}
				}
			}
		}
	}
	
	option = { # Hire skilled mercenaries
		name = wasteland_blocker.0001.d
		remove_short_term_gold = 100
		random_list = { 
			75 = {
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0001.success.toast.t
					scope:obstacle_province = { remove_building = wolf_den_cleared }
				}
			}
			25 = {
				send_interface_toast = {
					left_icon = root
					title = wasteland_blocker.0001.failure.toast.t
					hidden_effect = { scope:obstacle_province = { remove_building = wolf_den_cleared } }
					scope:obstacle_province = { add_building = wolf_den }
				}
			}
		}
	}
	
	option = { # Leave the wolves alone
		name = wasteland_blocker.0001.e
		hidden_effect = { scope:obstacle_province = { remove_building = wolf_den_cleared } }
		scope:obstacle_province = { add_building = wolf_den }
	}
}