namespace = realms_galadhrim_filler

##########################################
# Strange markings
##########################################

realms_galadhrim_filler.100 = { # Your border sentries bring forth grim news. Strange painting have been witnessed in certain Mallorn trees on the outskirts of Lothlórien - laying on the tree's trunk, was burned a black eye with a red lid. 
	type = character_event
	title = realms_galadhrim_filler.100
	desc = realms_galadhrim_filler.100_desc
	theme = realm
	# override_background = {
	# 	event_background = throne_room_galadhrim
	# }

	left_portrait = {
		character = root
		animation = disapproval
	}

	right_portrait = {
		character = cp:councillor_marshal
		animation = worry
	}

	immediate = {	
		add_character_flag = {
			flag = strange_marks_trees_filler
			years = 15
		}
	}

	trigger = { 
		capital_county.title_province = {
			geographical_region = middleearth_west_lothlorien
		}
		is_imprisoned = no
		is_incapable = no
		is_in_an_activity = no
		NOT = {
			has_character_flag = strange_marks_trees_filler
		}
		# NOT =  { # Jaco_Daan: commented out due to not sure how to check for marshal
		# 	cp:councillor_marshal = 
		# }
		is_elf = yes
	}
	

	option = {	# Join the watch for the next few days
		name = realms_galadhrim_filler.100.a
		custom_tooltip = realms_galadhrim_filler.100.a_tt
		if = {
			limit = {
				has_trait = paranoid
			}
			add_stress = 40
		}
		else = {
			trigger_event = {
				id = realms_galadhrim_filler.101
				days = 14
			}
		}
	}

	option = {	# Increases the guard for some small payment to marshal  
		name = realms_galadhrim_filler.100.b
		custom_tooltip = realms_galadhrim_filler.100.b_tt
		pay_short_term_gold = {
			target = cp:councillor_marshal
			gold = 50
		}
		trigger_event = {
			id = realms_galadhrim_filler.102
			days = 7
		}
	}

	option = {	# Ignore problem, as you are too busy     ----> DONE
		name = realms_galadhrim_filler.100.c
		custom_tooltip = realms_galadhrim_filler.100.c_tt
		trigger_event = {
			id = realms_galadhrim_filler.103
			months = { 2 3 }
		}
	}
}

##########################################
# Strange markings - Joined watch
##########################################

realms_galadhrim_filler.101 = { # You have joined your men in their watch tonight. Fate has decried that a guard post has fallen under attack a short distance away - the enemy has made their move, it is up to the Galadhrim to defend their homeland.
	type = character_event
	title = realms_galadhrim_filler.101
	desc = realms_galadhrim_filler.101_desc
	theme = realm
	override_background = {     	
      event_background = wilderness_forest
	}

	left_portrait = {
		character = root
		animation = war_defender
	}

	right_portrait = {
		character = cp:councillor_marshal
		animation = war_defender
	}

	option = {	# Fight from the trees 		----> DONE
		name = realms_galadhrim_filler.101.a
		custom_tooltip = realms_galadhrim_filler.101.a_tt
		
		trigger_event = {
			id = realms_galadhrim_filler.103
			days = { 5 10 }
		}
	}

	option = {	#Assualt them on the ground
		name = realms_galadhrim_filler.101.b
		custom_tooltip = realms_galadhrim_filler.101.b_tt
		if = {
			limit = { has_trait = brave }
			add_prestige = 150
		}
		trigger_event = {
			id = realms_galadhrim_filler.105
			days = { 5 10 }
		}
	}
}

##########################################
# Strange markings - Ambushed orcs
##########################################

realms_galadhrim_filler.102 = { # The Galadhrim caught the enemy off guard. As arrows fly from the tall trees, their archers' aim true, the clang of unsheath blades fills the air, and you and your brothers plunge into the Orc ranks - you are noticed by a champion.
	type = character_event
	title = realms_galadhrim_filler.102
	desc = realms_galadhrim_filler.102_desc
	theme = realm
	override_background = {     
      event_background = wilderness_forest
	}

	left_portrait = {
		character = root
		animation = war_attacker
	}

	right_portrait = {
		character = scope:orc_1
		animation = war_defender
	}

	immediate = {
		create_character = {
			location = root.location
			culture = culture:kazgumhoth
			faith = faith:lidless_eye
			age = { 18 40 }
			gender = male
			trait = sadistic
			random_traits = yes
			random_traits_list = { 
				count = 1 
				blademaster_1 = { weight = { base = 80 } } 
				blademaster_2 = { weight = { base = 30 } } 
				blademaster_3 = { weight = { base = 10 } } 
			}
			
			after_creation = {
				set_to_lowborn = yes
				save_scope_as = orc_1
			}
		}
	}

	option = {	# Fights against band of orcs yourself
		name = realms_galadhrim_filler.102.a
		custom_tooltip = realms_galadhrim_filler.102.a_tt
		configure_start_single_combat_effect = {
			SC_INITIATOR = root
			SC_ATTACKER = root
			SC_DEFENDER = scope:orc_1
			FATALITY = yes
			FIXED = no
			LOCALE = terrain_scope
			OUTPUT_EVENT = realms_galadhrim_filler.105
			INVALIDATION_EVENT = realms_galadhrim_filler.107
		}
	}

	option = { # you paid for extra sentries, lets use them!
		name = realms_galadhrim_filler.102.b
		custom_tooltip = realms_galadhrim_filler.102.b_tt
		if = { 
			limit = { 
				has_trait = brave
			}
			add_stress = 30
		}
		if = { 
			limit = { 
				has_trait = craven
			}
			add_stress = -25
		}
		trigger_event = {
			id = realms_galadhrim_filler.108
			days = 10
		}
	}
}

##########################################
# Strange markings - disaster
##########################################

realms_galadhrim_filler.103 = { # Dark have been your people's days as of late. A firey swathe has destroyed a large portion of your sacred trees, forever lost to the flame's hunger. The culprits are nowhere to be found.
	type = character_event
	title = realms_galadhrim_filler.103
	desc = realms_galadhrim_filler.103_desc
	theme = realm

	left_portrait = {
		character = root
		animation = dismissal
	}

	right_portrait = {
		character = cp:councillor_marshal  #TODO use court bishop
		animation = anger
	}

	option = {	# They shall grow back anyway.. 
		name = realms_galadhrim_filler.103.a
		custom_tooltip = realms_galadhrim_filler.103.a_tt
		add_character_modifier = let_forest_burn_filler_modifier
		add_prestige = -200
	}
}

##########################################
# Strange markings - relief attempt
##########################################

realms_galadhrim_filler.104 = { # As you arrive into the scene, your people are clashing against the invaders, a brutal melee rages in the glades.
	type = character_event
	title = realms_galadhrim_filler.104
	desc = realms_galadhrim_filler.104_desc
	theme = realm
	override_background = {     
      event_background = wilderness_forest
	}

	left_portrait = {
		character = root
		animation = war_attacker
	}

	right_portrait = {
		character = cp:councillor_marshal
		animation = war_defender
	}

	option = {	# Attack! Let none of these monsters leave the forest!
		name = realms_galadhrim_filler.104.a
		custom_tooltip = realms_galadhrim_filler.104.a_tt
		trigger_event = {
			id = realms_galadhrim_filler.102 
		}
	}
}

##########################################
# Strange markings - Captain duel
##########################################

realms_galadhrim_filler.105 = { # As your enemy falls under your might, another one steps into the fray. A quick glance lets you notice the tide is turning in your favor, but first you need to fell yet another foe. "Akzshââk is my name" cries, announcing himself as the leader of these raiders. "When you soon lie dead at my feet, feel shame in knowing I will eat your mongrels. I will burn your forest to the ground, for the glory of Sauron."
	type = character_event
	title = realms_galadhrim_filler.105
	desc = realms_galadhrim_filler.105_desc
	theme = realm
	override_background = {     
      event_background = wilderness_forest
	}

	left_portrait = {
		character = root
		animation = war_defender
	}

	right_portrait = {
		character = scope:orc_leader
		animation = war_attacker
	}

	immediate = {
		add_character_flag = killed_first_champion_filler
		create_character = {
			name = Akzshââk
			age = { 18 40 }
			gender = male
			random_traits = yes
			trait = sadistic
			trait = sorcerer_01		
			random_traits_list = { 
				count = 1 
				blademaster_1 = { weight = { base = 80 } } 
				blademaster_2 = { weight = { base = 50 } } 
				blademaster_3 = { weight = { base = 30 } } 
			}
			location = root.location
			faith = faith:lidless_eye
			culture = culture:kazgumhoth
			save_scope_as = orc_leader
			after_creation = {
				scope:orc_leader = {
					random_list = {
						10 = {
							give_nickname = nick_the_defiler
						}
						10 = {
							give_nickname = nick_the_breaker
						}
						10 = {
							give_nickname = nick_shield_master
						}
						10 = {
							give_nickname = nick_the_gutless
						}
						10 = {
							give_nickname = nick_the_smasher
						}
					}
				}
				set_to_lowborn = yes
			} 
		}
	}

	option = {	# If your kind truly hail from the depths of Morgoth's evil, when you return there, tell your kindred it was $PLAYER_NAME$ who threw you back!
		name = realms_galadhrim_filler.105.a
		configure_start_single_combat_effect = {
			SC_INITIATOR = scope:orc_leader
			SC_ATTACKER = scope:orc_leader
			SC_DEFENDER = root
			FATALITY = yes
			FIXED = no
			LOCALE = terrain_scope
			OUTPUT_EVENT = realms_galadhrim_filler.106
			INVALIDATION_EVENT = realms_galadhrim_filler.107 #TODO last event in queue
		}
	}
}

##############################################
#	You've won the skirmish decisively
##############################################

realms_galadhrim_filler.106 = {
	type = character_event
	title = realms_galadhrim_filler.106
	desc = realms_galadhrim_filler.106_desc
	theme = realm

	left_portrait = {
		character = root
		animation = war_over_win
	}

	right_portrait = {
		character = cp:councillor_marshal
		animation = war_over_win
	}

	option = {
		name = realms_galadhrim_filler.106.a
		if = {
			limit = {
				NOT = { has_character_flag = had_nickname_event }
			}
			hidden_effect = {
				random = {
					chance = 50
					give_nickname = nick_the_bulwark_of_the_glades
					add_character_flag = had_nickname_event
				}
			}
			
		}
		if = {
			limit = {
				has_trait = zealous
			}
			add_prestige = 500
		} else = {
			add_prestige = 350
		}
	}
}


##########################################
# Strange markings - battle end (CAPTAIN KILLED)
##########################################

#### Jaco_Daan: Commented this out, as currently im not sure how to limit this SC starting immediately after
#### 			the first one finishes, which creates 3 event panes. Im currently just going to use the first SC.  (SC -> Single Combat)

# realms_galadhrim_filler.106 = { # It's over. The orc marauder lies lifeless at your feet, his warband scattered, falling one by one to your archers' perfectly aimed arrows. 
# 	type = character_event
# 	title = realms_galadhrim_filler.106
# 	desc = realms_galadhrim_filler.106_desc
# 	theme = realm
# 	# override_background = {     
#     #     event_background = throne_room_galadhrim
# 	# }

# 	left_portrait = {
# 		character = root
# 		animation = war_over_win
# 	}

# 	right_portrait = {
# 		character = cp:councillor_marshal
# 		animation = war_over_win
# 	}

# 	option = {	# Taug Lothlórien hi aur!
# 		name = realms_galadhrim_filler.106.a
# 	#	if = {	#juke note: nickname doesnt exist, an entire dynasty prestige level is insanely powerful for killing some orcs. I dont know what this event is for but i replaced it with 500 prestige for now
# 	#		limit = {
# 	#			NOT = {flag = had_nickname_event}
# 	#		}
# 	#		random = {
# 	#			chance = 30
# 	#			give_nickname = nick_the_bulwark_of_the_glades
# 	#		}
# 	#	}
# 	#	root.dynasty = {
# 	#		add_dynasty_prestige_level = 1
# 	#	}
# 	if = {
# 		limit = {
# 			has_trait = zealous
# 		}
# 		add_prestige = 500
# 	} else = {
# 		add_prestige = 350
# 	}
		
#	}
#}

##########################################
# Strange markings - defeat
##########################################

realms_galadhrim_filler.107 = { # You can hear your companions' woe screams around you... your $marshall name$ rushes towards you, as you fall to your knees.. All goes dark..
	type = character_event
	title = realms_galadhrim_filler.107.t
	desc = realms_galadhrim_filler.107_desc
	theme = realm
	override_background = {     
      event_background = battlefield
	}

	left_portrait = {
		character = root
		animation = severelyinjured
	}

	right_portrait = {
		character = cp:councillor_marshal
		animation = severelyinjured
	}

	immediate = {
		if = {
			limit = {
				has_character_flag = killed_first_champion_filler
			}
			cp:councillor_marshal = {
				death = { 
					killer = scope:orc_leader
					death_reason = death_duel
				}
			}
		}
		else = {
			cp:councillor_marshal = {
				death = { 
					killer = scope:orc_1
					death_reason = death_duel
				}
			}
		}
	}
	option = {	# I see.. a grey, cloudy curtain... it's rolling back...
		name = realms_galadhrim_filler.107.a
		custom_tooltip = realms_galadhrim_filler.107.a_tt
		if = {
			limit = {
				has_character_flag = killed_first_champion_filler
			}
			death = { 
				killer = scope:orc_leader
				death_reason = death_duel
			}
		}
		else = {
			death = { 
				killer = scope:orc_1
				death_reason = death_duel
			}
		}
	}
}

#############################################################
# STRANGE MARKINGS - WIN, DID NOT JOIN -> added by Jaco_Daan
#############################################################

realms_galadhrim_filler.108 = {
	type = character_event
	title = realms_galadhrim_filler.108
	desc = realms_galadhrim_filler.108_desc
	theme = realm

	override_background = {     
      event_background = battlefield
	}

	left_portrait = {
		character = root
		animation = idle
	}

	option = {
		name = realms_galadhrim_filler.108.a
		if = {
			limit = {
				OR = {
					has_trait = brave
					has_trait = zealous
					has_trait = wrathful
				}
			}
			add_stress = 30
			add_prestige = -350
		}

		if = {
			limit = {
				has_trait = craven
				has_trait = paranoid
				has_trait = arbitrary
			}
			add_stress = -20
			add_prestige = -150
		}
		add_character_modifier = {
			modifier = took_account_of_actions
			years = 5
		}
	}

}

