namespace = khand

### Khand Events ###

#		khand.0100 #Introduction
#		khand.0210-0260 #Challenges
#		khand.0300 #Conclusion
#       khand.0900 # Finish with result
#       khand.0999 # Finish with no result


khand.0100 = { # Khand: Introduction of "Presenting the Heir"
	title = khand.0100.t
	desc = khand.0100.desc
	theme = southern_throne
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = root.player_heir
		animation = personality_bold
	}
	
	option = { # Introduce the heir
		name = khand.0100.a
		trigger_event = {
			id = khand.0210
			days = 1
		}
	}
	option = { # Cancel
		name = khand.0999.a
		trigger_event = {
			id = khand.0999 # Finish with no results
			days = 1
		}
	}
}

khand.0210 = { # Khand: Challenge 1: Martial
	title = khand.0210.t
	desc = khand.0210.desc
	theme = southern_throne
	left_portrait = {
		character = root.player_heir
		animation = personality_bold
	}
	immediate = {
		scope:khand_decision = {
			
			random_in_list = {
				variable = potential_vassal
				limit = {
					is_alive = yes
				}
				save_scope_as = next_vassal				
				remove_from_list = potential_vassal
			}
		}
	}
	right_portrait = {
		character = scope:next_vassal
		animation = personality_bold
	}
	
	option = { # Next duel
		name = khand.0210.a
		custom_tooltip = khand.0210.a.desc
		duel = {
			skill = martial 
			value = high_skill_rating
			50 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
					min = -19
				}
				desc = khand.0210.duel_success
				send_interface_toast = {
					left_icon = root.primary_heir
					title = khand.0210.success
					
					if = {
						limit = {					
							scope:khand_decision = {
								any_in_list = {
									list = potential_vassal
									count > 0 
								}
							}
						}
						trigger_event = {
							id = khand.0220
							days = 1
						}
					}
					else = {
						trigger_event = {
							id = khand.0900
							days = 1
						}
					}
				}
			}
			100 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -1
					min = -19
				}
				desc = khand.0210.duel_failure
				send_interface_toast = {
					left_icon = root.primary_heir
					title = khand.0210.failure
					
					root.player_heir = {
						increase_wounds_effect = {
								REASON = duel
						}
					}
					if = {
						limit = {					
							scope:khand_decision = {
								any_in_list = {
									list = potential_vassal
									count > 0 
								}
							}
						}
						trigger_event = {
							id = khand.0220
							days = 1
						}
					}
					else = {
						trigger_event = {
							id = khand.0900
							days = 1
						}
					}
				}
			}
		}
	}
	option = { # Cancel
		name = khand.0999.a
		trigger_event = {
			id = khand.0999 # Finish with no results
			days = 1
		}
	}
}

khand.0220 = {  # Khand: Challenge 2: Prowess
	title = khand.0220.t
	desc = khand.0220.desc
	theme = southern_throne
	left_portrait = {
		character = root.player_heir
		animation = personality_bold
	}
	immediate = {
		scope:khand_decision = {
			
			random_in_list = {
				variable = potential_vassal
				limit = {
					is_alive = yes
				}
				save_scope_as = next_vassal				
				remove_from_list = potential_vassal
			}
		}
	}
	right_portrait = {
		character = scope:next_vassal
		animation = personality_bold
	}
	
	option = { # Introduce the heir
		name = khand.0220.a
		custom_tooltip = khand.0220.a.desc
		duel = {
			skill = prowess 
			value = high_skill_rating
			50 = { 
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
					min = -19
				}
				desc = khand.0220.duel_success
			}
			100 = {
				compare_modifier = {
					value = scope:duel_value
					multiplier = -1
					min = -19
				}
				desc = khand.0220.duel_failure
				add_prestige = medium_prestige_loss
			}
		}
		after = {
			if = {
				limit = {					
					scope:khand_decision = {
						any_in_list = {
							list = potential_vassal
							count > 0 
						}
					}
				}
				trigger_event = {
					id = khand.0230
					days = 1
				}
			}
			else = {
				trigger_event = {
					id = khand.0900
					days = 1
				}
			}
		}
	}
	option = { # Cancel
		name = khand.0999.a
		trigger_event = {
			id = khand.0999 # Finish with no results
			days = 1
		}
	}
}

khand.0230 = {  # Khand: Challenge 3: Diplomacy
	title = khand.0100.t
	desc = khand.0100.desc
	theme = southern_throne
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = root.player_heir
		animation = personality_bold
	}
	
	option = { # Introduce the heir
		name = khand.0100.a
		trigger_event = {
			id = khand.0240
			days = 10
		}
	}
	option = { # Cancel
		name = khand.0999.a
		trigger_event = {
			id = khand.0999 # Finish with no results
			days = 1
		}
	}
}

khand.0240 = {  # Khand: Challenge 4: Learning
	title = khand.0100.t
	desc = khand.0100.desc
	theme = southern_throne
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = root.player_heir
		animation = personality_bold
	}
	
	option = { # Introduce the heir
		name = khand.0100.a
		trigger_event = {
			id = khand.0250
			days = 10
		}
	}
	option = { # Cancel
		name = khand.0999.a
		trigger_event = {
			id = khand.0999 # Finish with no results
			days = 1
		}
	}
}

khand.0250 = {  # Khand: Challenge 5: Stewardship
	title = khand.0100.t
	desc = khand.0100.desc
	theme = southern_throne
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = root.player_heir
		animation = personality_bold
	}
	
	option = { # Introduce the heir
		name = khand.0260.a
		trigger_event = {
			id = khand.0260
			days = 10
		}
	}
	option = { # Cancel
		name = khand.0999.a
		trigger_event = {
			id = khand.0999 # Finish with no results
			days = 1
		}
	}
}

khand.0260 = {  # Khand: Challenge 6: Intrigue
	title = khand.0100.t
	desc = khand.0100.desc
	theme = southern_throne
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = root.player_heir
		animation = personality_bold
	}
	
	option = { # Introduce the heir
		name = khand.0100.a
		trigger_event = {
			id = khand.0300
			days = 10
		}
	}
	option = { # Cancel
		name = khand.0999.a
		trigger_event = {
			id = khand.0999 # Finish with no results
			days = 1
		}
	}
}


khand.0300 = {  # Khand: Conclusion
	title = khand.0100.t
	desc = khand.0100.desc
	theme = southern_throne
	left_portrait = {
		character = root
		animation = personality_bold
	}
	right_portrait = {
		character = root.player_heir
		animation = personality_bold
	}
	
	option = { # Introduce the heir
		name = khand.0100.a
		trigger_event = {
			id = khand.0300
			days = 10
		}
	}
	option = { # Cancel
		name = khand.0999.a
		trigger_event = {
			id = khand.0999 # Finish with no results
			days = 1
		}
	}
}

khand.0900 = {  # Khand: Reward
	title = khand.0100.t
	desc = khand.0100.desc
	theme = southern_throne
	left_portrait = {
		character = root
		animation = personality_honorable
	}
	right_portrait = {
		character = root.player_heir
		animation = personality_honorable
	}
	
	option = { # Cancel
		name = khand.0999.a
	}
}


khand.0999 = {  # Khand: No reward
	title = khand.0999.t
	desc = khand.0999.desc
	theme = southern_throne
	left_portrait = {
		character = root
		animation = personality_dishonorable
	}
	right_portrait = {
		character = root.player_heir
		animation = personality_dishonorable
	}
	
	option = { # Cancel
		name = khand.0999.a
	}
}