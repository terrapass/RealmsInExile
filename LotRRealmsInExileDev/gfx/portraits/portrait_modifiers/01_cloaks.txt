
cloaks = {

	usage = game

	western_kings = {
		# outfit_tags = { rank_headgear } 
		dna_modifiers = {
			accessory = {
				mode = add
				
				gene = cloaks
				template = western_royalty
				range = { 0 1 }
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 100
				OR = {
					portrait_adunai_clothing_trigger = yes
					AND = {
						portrait_northron_clothing_trigger = yes
						OR = {
							portrait_vale_woodmen_clothing_trigger = no
							AND = {
								portrait_vale_woodmen_clothing_trigger = yes
								NOR = {
									has_government = tribal_government
#									religion = religion:germanic_religion
								}
							}
						}
					}
					portrait_bellakari_clothing_trigger = yes
					portrait_numenorean_clothing_trigger = yes
					portrait_elven_clothing_trigger = yes
					portrait_dalemen_clothing_trigger = yes
					portrait_dorwinion_clothing_trigger = yes
				}
			}
			modifier = { # For Sauruman and Sauron
				factor = 0
				OR = { 
					has_character_flag = is_saruman	
					has_character_flag = is_sauron
					has_trait = nazgul
				}
			}
			modifier = {
				factor = 0
				exists = this
				OR = {
					is_adult = no
					highest_held_title_tier < tier_kingdom
					has_government = theocracy_government
					has_government = republic_government
					has_character_modifier = vow_of_poverty_modifier
					# Deliberately not the "fully naked" one since dropping your cloak's intended even if nudity is disabled
					should_be_naked_trigger = yes
				}
			}			
		}
	}

	no_cloak = {
		dna_modifiers = {
			accessory = {
				mode = add
				
				gene = cloaks
				template = no_cloak
				range = { 0 1 }
			}
		}	
        outfit_tags = { no_clothes }
		weight = {
			base = 0
			modifier = { # Don't wear a cloak while wearing armour
				add = 1000
				portrait_wear_armor_trigger = yes
			}
			modifier = {
				add = 60
				portrait_gwathiurim_clothing_trigger = yes
			}	
			modifier = {
				add = -30
				portrait_gwathiurim_clothing_trigger = yes
				highest_held_title_tier >= tier_county
			}	
			modifier = {
				add = -15
				portrait_gwathiurim_clothing_trigger = yes
				exists = primary_spouse
				OR = {
					is_ruler = no
					highest_held_title_tier = tier_barony
				}
				primary_spouse = {
					highest_held_title_tier >= tier_county
				}
			}	
			modifier = {
				add = -30
				portrait_gwathiurim_clothing_trigger = yes
				highest_held_title_tier >= tier_duchy
			}	
			modifier = {
				add = -15
				portrait_gwathiurim_clothing_trigger = yes
				exists = primary_spouse
				OR = {
					is_ruler = no
					highest_held_title_tier = tier_barony
				}
				primary_spouse = {
					highest_held_title_tier >= tier_duchy
				}
			}	
			modifier = {
				add = -60
				portrait_gwathiurim_clothing_trigger = yes
				OR = {
					portrait_wear_armor_trigger = yes
					has_trait = berserker
				}
			}
			modifier = {
				add = 300
				OR = {
					has_primary_title = title:e_gondor
					has_primary_title = title:e_castamir
				}
                OR = {
                    portrait_gondorian_clothing_trigger = yes
                    portrait_harondorim_clothing_trigger = yes
                }
			}
		}
	}

	fp1_norse = {
		dna_modifiers = {
			accessory = {
				mode = add
				
				gene = cloaks
				template = fp1_cloak
				range = { 0 1 }
			}
			morph = {
				mode = add
				
				gene = gene_bs_cloak
				template = cloak
				value = 1.0
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 40
				portrait_vale_woodmen_clothing_trigger = yes
			}
			modifier = {
				factor = 0
				OR = {
					is_adult = no
					has_government = theocracy_government
					is_theocratic_lessee = yes
					has_character_modifier = vow_of_poverty_modifier
					# Deliberately not the "fully naked" one since dropping your cloak's intended even if nudity is disabled
					should_be_naked_trigger = yes
				}
			}			
		}
	}

	fp1_norse_berserker = {
		dna_modifiers = {
			accessory = {
				mode = add
				
				gene = cloaks
				template = fp1_cloak_berserker
				range = { 0 1 }
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 100
				has_fp1_dlc_trigger = yes
				portrait_vale_woodmen_clothing_trigger = yes
				has_trait = berserker
			}
			modifier = {
				factor = 0
				OR = {
					is_adult = no
					has_government = theocracy_government
					is_theocratic_lessee = yes
					has_character_modifier = vow_of_poverty_modifier
					# Deliberately not the "fully naked" one since dropping your cloak's intended even if nudity is disabled
					should_be_naked_trigger = yes
					has_trait = nazgul
				}
			}			
		}
	}
	
	ep1_adventurer_cloak = {
		dna_modifiers = {
			accessory = {
				mode = add
				
				gene = cloaks
				template = ep1_cloak_adventurer
				range = { 0 1 }
			}
		}
		outfit_tags = { ep1_adventurer_cloak }
		weight = {
			base = 0
			modifier = {
				add = 100
				has_ep1_dlc_trigger = yes
				OR = {
					AND = {
						NOT =  {
							portrait_fp1_norse_clothing_trigger = yes
						}
						portrait_has_trait_trigger = { TRAIT = adventurer }
					}
					AND = {
						exists = inspiration
						inspiration = {
							has_inspiration_type = adventure_inspiration
						}
					}
				}
			}
			modifier = {
				factor = 0
				OR = {
					is_adult = no
					has_government = theocracy_government
					is_theocratic_lessee = yes
					has_character_modifier = vow_of_poverty_modifier
					# Deliberately not the "fully naked" one since dropping your cloak's intended even if nudity is disabled
					should_be_naked_trigger = yes
				}
			}			
		}
	}
	
### ROHIRRIM ###
	rohirrim_nobility = {
		# outfit_tags = { rank_headgear } 
		dna_modifiers = {
			accessory = {
				mode = add
				
				gene = cloaks
				template = rohirrim_nobility
				range = { 0 1 }
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 150
				AND = {
					portrait_rohirrim_clothing_trigger = yes
					highest_held_title_tier >= tier_kingdom
				}
			}
			modifier = {
				factor = 0
				OR = {
					is_adult = no
					should_be_naked_trigger = yes
					has_trait = nazgul
					portrait_wear_armor_trigger = yes
				}
			}			
		}
	}
	
	theoden_cloak = {
		# outfit_tags = { rank_headgear } 
		dna_modifiers = {
			accessory = {
				mode = add
				
				gene = cloaks
				template = theoden_cloak
				range = { 0 1 }
			}
		}	
		weight = {
			base = 0
            modifier = {
                add = 1000
				exists = character:6000017 #Theoden
				this = character:6000017 #Theoden
            }
		}
	}
	
## GONDORIAN ##	
	gondorian_royalty = {
		# outfit_tags = { rank_headgear } 
		dna_modifiers = {
			accessory = {
				mode = add
				
				gene = cloaks
				template = gondorian_royalty
				range = { 0 1 }
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 200
                OR = {
                    portrait_gondorian_clothing_trigger = yes
                    portrait_harondorim_clothing_trigger = yes
                }
			}
			modifier = {
				factor = 0
				OR = {
					is_adult = no
					highest_held_title_tier < tier_kingdom
					has_government = theocracy_government
					has_government = republic_government
					# Deliberately not the "fully naked" one since dropping your cloak's intended even if nudity is disabled
					should_be_naked_trigger = yes
					has_trait = nazgul
				}
			}			
		}
	}
	
## WITCHES AND ALCHEMISTS ##
	
	wam_evil_cloaks = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = cloaks
				template = wam_evil_cloaks
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		outfit_tags = { wam_evil_witch }
		weight = {
			base = 0
			#modifier = {
			#	add = 101
			#	exists = this
			#	wam_portrait_is_witch_trigger = yes
			#	wam_portrait_witchcraft_is_evil_trigger = yes
			#}
		}
	}
	
	wam_light_cloaks = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = cloaks
				template = wam_light_cloaks
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		outfit_tags = { wam_light_witch }
		weight = {
			base = 0
			modifier = {
				add = 101
				exists = this
				has_trait = istari
				NOT = { this = character:6000053 } #NOT SARUMAN
			}
		}
	}	
}