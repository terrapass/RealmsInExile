display_magic_capacity = {
	scope = character
	is_shown = {
		can_cast_spells_trigger = yes
	}
	effect = {
                custom_tooltip = magic_capacity
	}
}

can_do_sorcery = {
	is_shown = {
		OR = {
			has_trait = sorcerer
			has_trait = nazgul
			is_evil_istari = yes
			has_trait = maiar
		}
	}
	is_valid = {
		NOT = {
			has_character_modifier = practiced_sorcery_recently
		}
		piety >= 500
	}
}

select_call_the_horde = {
	is_valid = {
		always = yes
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:call_the_horde
		}
	}
}
select_mark_of_war = {
	is_valid = {
		always = yes
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:mark_of_war
		}
	}
}
select_assemble_the_warchiefs = {
	is_valid = {
		always = yes
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:assemble_the_warchiefs
		}
	}
}
select_rise_the_dead = {
	is_valid = {
		always = yes
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:rise_the_dead
		}
	}
}
select_invoke_watchers = {
	is_valid = {
		always = yes
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:invoke_watchers
		}
	}
}
select_summon_being_of_darkness = {
	is_valid = {
		NOT = { has_character_modifier = fell_beast_mount_modifier }
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:summon_being_of_darkness
		}
	}
}
select_cracks_of_the_earth = {
	is_valid = {
		always = yes
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:cracks_of_the_earth
		}
	}
}
select_dark_vitality = {
	is_valid = {
		always = yes
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:dark_vitality
		}
	}
}
select_words_of_power = {
	is_valid = {
		is_at_war = yes
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:words_of_power
		}
	}
}
select_forge_morgul_weapons = {
	is_valid = {
		NOT = { has_character_modifier = morgul_weapons }
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:forge_morgul_weapons
		}
	}
}
select_purse_them_relentlessly = {
	is_valid = {
		OR = {
			has_trait = nazgul
		}
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:purse_them_relentlessly
		}
	}
}
select_black_breath = {
	is_valid = {
		OR = {
			has_trait = nazgul
			has_trait = maiar
		}
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:black_breath
		}
	}
}
select_nazgul_restoration = {
	is_valid = {
		OR = {
			has_trait = nazgul
			has_trait = maiar
		}
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:nazgul_restoration
		}
	}
}
select_ambassador_of_darkness = {
	is_valid = {
		has_trait = maiar
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:ambassador_of_darkness
		}
	}
}
select_shapeshifting = {
	is_valid = {
		has_trait = maiar
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:shapeshifting
		}
	}
}
select_reveal_the_secrets = {
	is_valid = {
		has_trait = maiar
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:reveal_the_secrets
		}
	}
}
select_cast_the_darkness = {
	is_valid = {
		has_trait = maiar
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:cast_the_darkness
		}
	}
}
select_abnormal_winter = {
	is_valid = {
		has_trait = maiar
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:abnormal_winter
		}
	}
}
select_the_plague = {
	is_valid = {
		has_trait = maiar
	}
	effect = {
		set_variable = {
			name = selected_spell
			value = flag:the_plague
		}
	}
}

unselect_spell = {	
	effect = {
		remove_variable = selected_spell
	}
}

unselect_location = {	
	effect = {
		remove_variable = ritual_location
	}
}

select_location = {
	effect = {
		trigger_event = evil.0001
	}

}


cast_call_the_horde = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}

		if = {limit = {exists = var:temple var:temple = 4}
			remove_short_term_gold = {
				value = 250
			}
		}
		else = {
			add_piety = {
				value = -250
				if = {limit = {exists = var:temple var:temple = 2} multiply = 0.8 subtract = 1}
			}
		}
		  switch = {
			trigger = var:ritual_location
			
			flag:sacred_place = {
				random_list = {
					25 = {	# Failure
						desc = evil.0022.a
						modifier = {add = var:low_mod}
						trigger_event = {
							id = evil.0122
							days = { 15 30 }
						}
						
						set_variable = {name = spell_result value = 0}
					}
					50 = {	# Success
						desc = evil.0023.a
						trigger_event = {
							id = evil.0123
							days = { 15 30 }
						}
							if = {
								limit = {root.faith = faith:melkorite}
								spawn_army = {
									men_at_arms = {
										type = black_numenorean_vanguard 
										stacks = 12
									}
									location = capital_province
									inheritable = no
									name = black_numenorean_event_troops
								}
							}
							if = {
								limit = {root.faith = faith:cult_of_zigur}
								random_list = {
									1 = {
										spawn_army = {
											men_at_arms = {
												type = guard_of_abrakhan 
												stacks = 10
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 6
											}
											location = capital_province
											inheritable = no
											name = decision_guard_of_abrakhan_troops
										}
										spawn_army = {
											men_at_arms = {
												type = guard_of_abrakhan 
												stacks = 10
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 6
											}
											location = capital_province
											inheritable = no
											name = decision_guard_of_abrakhan_troops
										}
									}
									1 = {
										spawn_army = {
											men_at_arms = {
												type = desert_screamers 
												stacks = 8
											}
											men_at_arms = {
												type = desert_screamers 
												stacks = 8
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 2
											}
											men_at_arms = {
												type = giant_scorpions 
												stacks = 1
											}
											location = capital_province
											inheritable = no
											name = haradrim_event_troops
										}
										spawn_army = {
											men_at_arms = {
												type = desert_screamers 
												stacks = 8
											}
											men_at_arms = {
												type = desert_screamers 
												stacks = 8
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 2
											}
											men_at_arms = {
												type = giant_scorpions 
												stacks = 1
											}
											location = capital_province
											inheritable = no
											name = haradrim_event_troops
										}
									}
								}
							}
							if = {
								limit = {root.faith = faith:white_hand_cult}
								random_list = {
									1 = {spawn_army = {
										men_at_arms = {
											type = urukhai_fighting 
											stacks = 10
										}
										men_at_arms = {
											type = urukhai_crossbowmen  
											stacks = 6
										}
										men_at_arms = {
											type = urukhai_pikemen
											stacks = 6
										}
										men_at_arms = {
											type = urukhai_berserker
											stacks = 1
										}
										men_at_arms = {
											type = urukhai_berserker
											stacks = 1
										}
										location = capital_province
										inheritable = no
										name = urukhai_event_troops
										}
									}
									1 = {spawn_army = {
										men_at_arms = {
											type = dunlending_huscarl 
											stacks = 8
										}
										men_at_arms = {
											type = dunlending_longbowmen 
											stacks = 4
										}
										men_at_arms = {
											type = dunlending_outriders
											stacks = 4
										}
										location = capital_province
										inheritable = no
										name = wildmen_event_troops
										}
									}
								}
							}
							if = {
								limit = {root.faith = faith:way_of_strength}
								spawn_army = {
									men_at_arms = {
										type = urukhai_fighting 
										stacks = 8
									}
									men_at_arms = {
										type = urukhai_crossbowmen 
										stacks = 4
									}
									men_at_arms = {
										type = mountainorc_warriors 
										stacks = 4
									}
									men_at_arms = {
										type = orc_warriors 
										stacks = 10
									}
									location = capital_province
									inheritable = no
									name = orc_event_troops
								}
							}
							if = {
								limit = {
									OR = {
										root.faith = faith:lidless_eye
										root.faith = faith:sons_of_sauron
										root.faith = faith:red_eye_cult
									}
								}
								random_list = {
									1 = {spawn_army = {
										men_at_arms = {
											type = urukhai_fighting 
											stacks = 8
										}
										men_at_arms = {
											type = urukhai_crossbowmen 
											stacks = 4
										}
										men_at_arms = {
											type = mountainorc_warriors 
											stacks = 4
										}
										men_at_arms = {
											type = orc_warriors 
											stacks = 10
										}
										location = capital_province
										inheritable = no
										name = orc_event_troops
										}
									}
									1 = {spawn_army = {
										men_at_arms = {
											type = serpent_guard 
											stacks = 8
										}
										men_at_arms = {
											type = desert_javelineers
											stacks = 8
										}
										men_at_arms = {
											type = haradrim_radiers
											stacks = 4
										}
										men_at_arms = {
											type = war_mumak
											stacks = 2
										}
										location = capital_province
										inheritable = no
										name = haradrim_event_troops
										}
									}
								}
							}
					}
					25 = {	# Critical Succes
						modifier = {add = var:high_mod}
						desc = evil.0024.a
						trigger_event = {
							id = evil.0124
							days = { 15 30 }
						}
						if = {
								limit = {root.faith = faith:melkorite}
								spawn_army = {
									men_at_arms = {
										type = black_numenorean_vanguard 
										stacks = 13
									}
									location = capital_province
									inheritable = no
									name = black_numenorean_event_troops
								}
							}
							if = {
								limit = {root.faith = faith:cult_of_zigur}
								random_list = {
									1 = {
										spawn_army = {
											men_at_arms = {
												type = guard_of_abrakhan 
												stacks = 11
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 7
											}
											location = capital_province
											inheritable = no
											name = decision_guard_of_abrakhan_troops
										}
										spawn_army = {
											men_at_arms = {
												type = guard_of_abrakhan 
												stacks = 11
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 7
											}
											location = capital_province
											inheritable = no
											name = decision_guard_of_abrakhan_troops
										}
									}
									1 = {
										spawn_army = {
											men_at_arms = {
												type = desert_screamers 
												stacks = 9
											}
											men_at_arms = {
												type = desert_screamers 
												stacks = 9
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 3
											}
											men_at_arms = {
												type = giant_scorpions 
												stacks = 2
											}
											location = capital_province
											inheritable = no
											name = haradrim_event_troops
										}
										spawn_army = {
											men_at_arms = {
												type = desert_screamers 
												stacks = 9
											}
											men_at_arms = {
												type = desert_screamers 
												stacks = 9
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 3
											}
											men_at_arms = {
												type = giant_scorpions 
												stacks = 2
											}
											location = capital_province
											inheritable = no
											name = haradrim_event_troops
										}
									}
								}
							}
							if = {
								limit = {root.faith = faith:white_hand_cult}
								random_list = {
									1 = {spawn_army = {
										men_at_arms = {
											type = urukhai_fighting 
											stacks = 11
										}
										men_at_arms = {
											type = urukhai_crossbowmen  
											stacks = 7
										}
										men_at_arms = {
											type = urukhai_pikemen
											stacks = 7
										}
										men_at_arms = {
											type = urukhai_berserker
											stacks = 2
										}
										men_at_arms = {
											type = urukhai_berserker
											stacks = 2
										}
										location = capital_province
										inheritable = no
										name = urukhai_event_troops
										}
									}
									1 = {spawn_army = {
										men_at_arms = {
											type = dunlending_huscarl 
											stacks = 9
										}
										men_at_arms = {
											type = dunlending_longbowmen 
											stacks = 5
										}
										men_at_arms = {
											type = dunlending_outriders
											stacks = 5
										}
										location = capital_province
										inheritable = no
										name = wildmen_event_troops
										}
									}
								}
							}
							if = {
								limit = {root.faith = faith:way_of_strength}
								spawn_army = {
									men_at_arms = {
										type = urukhai_fighting 
										stacks = 9
									}
									men_at_arms = {
										type = urukhai_crossbowmen 
										stacks = 5
									}
									men_at_arms = {
										type = mountainorc_warriors 
										stacks = 5
									}
									men_at_arms = {
										type = orc_warriors 
										stacks = 11
									}
									location = capital_province
									inheritable = no
									name = orc_event_troops
								}
							}
							if = {
								limit = {
									OR = {
										root.faith = faith:lidless_eye
										root.faith = faith:sons_of_sauron
										root.faith = faith:red_eye_cult
									}
								}
								random_list = {
									1 = {spawn_army = {
										men_at_arms = {
											type = urukhai_fighting 
											stacks = 9
										}
										men_at_arms = {
											type = urukhai_crossbowmen 
											stacks = 5
										}
										men_at_arms = {
											type = mountainorc_warriors 
											stacks = 5
										}
										men_at_arms = {
											type = orc_warriors 
											stacks = 11
										}
										location = capital_province
										inheritable = no
										name = orc_event_troops
										}
									}
									1 = {spawn_army = {
										men_at_arms = {
											type = serpent_guard 
											stacks = 9
										}
										men_at_arms = {
											type = desert_javelineers
											stacks = 9
										}
										men_at_arms = {
											type = haradrim_radiers
											stacks = 5
										}
										men_at_arms = {
											type = war_mumak
											stacks = 3
										}
										location = capital_province
										inheritable = no
										name = haradrim_event_troops
										}
									}
								}
							}
					}
				}
			}
			flag:wilds = {
				random_list = {
					25 = {	# Critical Failure
						desc = evil.0021.a
						trigger_event = {
							id = evil.0121
							days = { 15 30 }
						}
						set_variable = {name = spell_result value = -1}
					}
					75 = {	# Failure
						desc = evil.0022.a
						trigger_event = {
							id = evil.0122
							days = { 15 30 }
						}
						set_variable = {name = spell_result value = 0}
					}
					75 = {	# Succes
						desc = evil.0023.a
						trigger_event = {
							id = evil.0123
							days = { 15 30 }
						}
						if = {
								limit = {root.faith = faith:melkorite}
								spawn_army = {
									men_at_arms = {
										type = black_numenorean_vanguard 
										stacks = 12
									}
									location = capital_province
									inheritable = no
									name = black_numenorean_event_troops
								}
							}
							if = {
								limit = {root.faith = faith:cult_of_zigur}
								random_list = {
									1 = {
										spawn_army = {
											men_at_arms = {
												type = guard_of_abrakhan 
												stacks = 10
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 6
											}
											location = capital_province
											inheritable = no
											name = decision_guard_of_abrakhan_troops
										}
										spawn_army = {
											men_at_arms = {
												type = guard_of_abrakhan 
												stacks = 10
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 6
											}
											location = capital_province
											inheritable = no
											name = decision_guard_of_abrakhan_troops
										}
									}
									1 = {
										spawn_army = {
											men_at_arms = {
												type = desert_screamers 
												stacks = 8
											}
											men_at_arms = {
												type = desert_screamers 
												stacks = 8
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 2
											}
											men_at_arms = {
												type = giant_scorpions 
												stacks = 1
											}
											location = capital_province
											inheritable = no
											name = haradrim_event_troops
										}
										spawn_army = {
											men_at_arms = {
												type = desert_screamers 
												stacks = 8
											}
											men_at_arms = {
												type = desert_screamers 
												stacks = 8
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 2
											}
											men_at_arms = {
												type = giant_scorpions 
												stacks = 1
											}
											location = capital_province
											inheritable = no
											name = haradrim_event_troops
										}
									}
								}
							}
							if = {
								limit = {root.faith = faith:white_hand_cult}
								random_list = {
									1 = {spawn_army = {
										men_at_arms = {
											type = urukhai_fighting 
											stacks = 10
										}
										men_at_arms = {
											type = urukhai_crossbowmen  
											stacks = 6
										}
										men_at_arms = {
											type = urukhai_pikemen
											stacks = 6
										}
										men_at_arms = {
											type = urukhai_berserker
											stacks = 1
										}
										men_at_arms = {
											type = urukhai_berserker
											stacks = 1
										}
										location = capital_province
										inheritable = no
										name = urukhai_event_troops
										}
									}
									1 = {spawn_army = {
										men_at_arms = {
											type = dunlending_huscarl 
											stacks = 8
										}
										men_at_arms = {
											type = dunlending_longbowmen 
											stacks = 4
										}
										men_at_arms = {
											type = dunlending_outriders
											stacks = 4
										}
										location = capital_province
										inheritable = no
										name = wildmen_event_troops
										}
									}
								}
							}
							if = {
								limit = {root.faith = faith:way_of_strength}
								spawn_army = {
									men_at_arms = {
										type = urukhai_fighting 
										stacks = 8
									}
									men_at_arms = {
										type = urukhai_crossbowmen 
										stacks = 4
									}
									men_at_arms = {
										type = mountainorc_warriors 
										stacks = 4
									}
									men_at_arms = {
										type = orc_warriors 
										stacks = 10
									}
									location = capital_province
									inheritable = no
									name = orc_event_troops
								}
							}
							if = {
								limit = {
									OR = {
										root.faith = faith:lidless_eye
										root.faith = faith:sons_of_sauron
										root.faith = faith:red_eye_cult
									}
								}
								random_list = {
									1 = {spawn_army = {
										men_at_arms = {
											type = urukhai_fighting 
											stacks = 8
										}
										men_at_arms = {
											type = urukhai_crossbowmen 
											stacks = 4
										}
										men_at_arms = {
											type = mountainorc_warriors 
											stacks = 4
										}
										men_at_arms = {
											type = orc_warriors 
											stacks = 10
										}
										location = capital_province
										inheritable = no
										name = orc_event_troops
										}
									}
									1 = {spawn_army = {
										men_at_arms = {
											type = serpent_guard 
											stacks = 8
										}
										men_at_arms = {
											type = desert_javelineers
											stacks = 8
										}
										men_at_arms = {
											type = haradrim_radiers
											stacks = 4
										}
										men_at_arms = {
											type = war_mumak
											stacks = 2
										}
										location = capital_province
										inheritable = no
										name = haradrim_event_troops
										}
									}
								}
							}
					}
					25 = {	# Critical Succes
						desc = evil.0024.a
						trigger_event = {
							id = evil.0124
							days = { 15 30 }
						}
						if = {
								limit = {root.faith = faith:melkorite}
								spawn_army = {
									men_at_arms = {
										type = black_numenorean_vanguard 
										stacks = 13
									}
									location = capital_province
									inheritable = no
									name = black_numenorean_event_troops
								}
							}
							if = {
								limit = {root.faith = faith:cult_of_zigur}
								random_list = {
									1 = {
										spawn_army = {
											men_at_arms = {
												type = guard_of_abrakhan 
												stacks = 11
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 7
											}
											location = capital_province
											inheritable = no
											name = decision_guard_of_abrakhan_troops
										}
										spawn_army = {
											men_at_arms = {
												type = guard_of_abrakhan 
												stacks = 11
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 8
											}
											location = capital_province
											inheritable = no
											name = decision_guard_of_abrakhan_troops
										}
									}
									1 = {
										spawn_army = {
											men_at_arms = {
												type = desert_screamers 
												stacks = 9
											}
											men_at_arms = {
												type = desert_screamers 
												stacks = 9
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 3
											}
											men_at_arms = {
												type = giant_scorpions 
												stacks = 2
											}
											location = capital_province
											inheritable = no
											name = haradrim_event_troops
										}
										spawn_army = {
											men_at_arms = {
												type = desert_screamers 
												stacks = 9
											}
											men_at_arms = {
												type = desert_screamers 
												stacks = 9
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 3
											}
											men_at_arms = {
												type = giant_scorpions 
												stacks = 2
											}
											location = capital_province
											inheritable = no
											name = haradrim_event_troops
										}
									}
								}
							}
							if = {
								limit = {root.faith = faith:white_hand_cult}
								random_list = {
									1 = {spawn_army = {
										men_at_arms = {
											type = urukhai_fighting 
											stacks = 11
										}
										men_at_arms = {
											type = urukhai_crossbowmen  
											stacks = 7
										}
										men_at_arms = {
											type = urukhai_pikemen
											stacks = 7
										}
										men_at_arms = {
											type = urukhai_berserker
											stacks = 2
										}
										men_at_arms = {
											type = urukhai_berserker
											stacks = 2
										}
										location = capital_province
										inheritable = no
										name = urukhai_event_troops
										}
									}
									1 = {spawn_army = {
										men_at_arms = {
											type = dunlending_huscarl 
											stacks = 9
										}
										men_at_arms = {
											type = dunlending_longbowmen 
											stacks = 5
										}
										men_at_arms = {
											type = dunlending_outriders
											stacks = 5
										}
										location = capital_province
										inheritable = no
										name = wildmen_event_troops
										}
									}
								}
							}
							if = {
								limit = {root.faith = faith:way_of_strength}
								spawn_army = {
									men_at_arms = {
										type = urukhai_fighting 
										stacks = 9
									}
									men_at_arms = {
										type = urukhai_crossbowmen 
										stacks = 5
									}
									men_at_arms = {
										type = mountainorc_warriors 
										stacks = 5
									}
									men_at_arms = {
										type = orc_warriors 
										stacks = 11
									}
									location = capital_province
									inheritable = no
									name = orc_event_troops
								}
							}
							if = {
								limit = {
									OR = {
										root.faith = faith:lidless_eye
										root.faith = faith:sons_of_sauron
										root.faith = faith:red_eye_cult
									}
								}
								random_list = {
									1 = {spawn_army = {
										men_at_arms = {
											type = urukhai_fighting 
											stacks = 9
										}
										men_at_arms = {
											type = urukhai_crossbowmen 
											stacks = 5
										}
										men_at_arms = {
											type = mountainorc_warriors 
											stacks = 5
										}
										men_at_arms = {
											type = orc_warriors 
											stacks = 11
										}
										location = capital_province
										inheritable = no
										name = orc_event_troops
										}
									}
									1 = {
									   spawn_army = {
										men_at_arms = {
											type = serpent_guard 
											stacks = 9
										}
										men_at_arms = {
											type = desert_javelineers
											stacks = 9
										}
										men_at_arms = {
											type = haradrim_radiers
											stacks = 5
										}
										men_at_arms = {
											type = war_mumak
											stacks = 3
										}
										location = capital_province
										inheritable = no
										name = haradrim_event_troops
										}
									}
								}
							}
					}
				}
			}
			flag:home = {
				random_list = {
					50 = {	# Failure
						desc = evil.0022.a
						trigger_event = {
							id = evil.0122
							days = { 15 30 }
						}
						set_variable = {name = spell_result value = 0}
					}
					50 = {	# Succes
						desc = evil.0023.a
						trigger_event = {
							id = evil.0123
							days = { 15 30 }
						}
						if = {
								limit = {root.faith = faith:melkorite}
								spawn_army = {
									men_at_arms = {
										type = black_numenorean_vanguard 
										stacks = 12
									}
									location = capital_province
									inheritable = no
									name = black_numenorean_event_troops
								}
							}
							if = {
								limit = {root.faith = faith:cult_of_zigur}
								random_list = {
									1 = {
										spawn_army = {
											men_at_arms = {
												type = guard_of_abrakhan 
												stacks = 10
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 6
											}
											location = capital_province
											inheritable = no
											name = decision_guard_of_abrakhan_troops
										}
										spawn_army = {
											men_at_arms = {
												type = guard_of_abrakhan 
												stacks = 10
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 6
											}
											location = capital_province
											inheritable = no
											name = decision_guard_of_abrakhan_troops
										}
									}
									1 = {
										spawn_army = {
											men_at_arms = {
												type = desert_screamers 
												stacks = 8
											}
											men_at_arms = {
												type = desert_screamers 
												stacks = 8
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 2
											}
											men_at_arms = {
												type = giant_scorpions 
												stacks = 1
											}
											location = capital_province
											inheritable = no
											name = haradrim_event_troops
										}
										spawn_army = {
											men_at_arms = {
												type = desert_screamers 
												stacks = 8
											}
											men_at_arms = {
												type = desert_screamers 
												stacks = 8
											}
											men_at_arms = {
												type = risen_carrion 
												stacks = 2
											}
											men_at_arms = {
												type = giant_scorpions 
												stacks = 1
											}
											location = capital_province
											inheritable = no
											name = haradrim_event_troops
										}
									}
								}
							}
							if = {
								limit = {root.faith = faith:white_hand_cult}
								random_list = {
									1 = {spawn_army = {
										men_at_arms = {
											type = urukhai_fighting 
											stacks = 10
										}
										men_at_arms = {
											type = urukhai_crossbowmen  
											stacks = 6
										}
										men_at_arms = {
											type = urukhai_pikemen
											stacks = 6
										}
										men_at_arms = {
											type = urukhai_berserker
											stacks = 1
										}
										men_at_arms = {
											type = urukhai_berserker
											stacks = 1
										}
										location = capital_province
										inheritable = no
										name = urukhai_event_troops
										}
									}
									1 = {spawn_army = {
										men_at_arms = {
											type = dunlending_huscarl 
											stacks = 8
										}
										men_at_arms = {
											type = dunlending_longbowmen 
											stacks = 4
										}
										men_at_arms = {
											type = dunlending_outriders
											stacks = 4
										}
										location = capital_province
										inheritable = no
										name = wildmen_event_troops
										}
									}
								}
							}
							if = {
								limit = {root.faith = faith:way_of_strength}
								spawn_army = {
									men_at_arms = {
										type = urukhai_fighting 
										stacks = 8
									}
									men_at_arms = {
										type = urukhai_crossbowmen 
										stacks = 4
									}
									men_at_arms = {
										type = mountainorc_warriors 
										stacks = 4
									}
									men_at_arms = {
										type = orc_warriors 
										stacks = 10
									}
									location = capital_province
									inheritable = no
									name = orc_event_troops
								}
							}
							if = {
								limit = {
									OR = {
										root.faith = faith:lidless_eye
										root.faith = faith:sons_of_sauron
										root.faith = faith:red_eye_cult
									}
								}
								random_list = {
									1 = {spawn_army = {
										men_at_arms = {
											type = urukhai_fighting 
											stacks = 8
										}
										men_at_arms = {
											type = urukhai_crossbowmen 
											stacks = 4
										}
										men_at_arms = {
											type = mountainorc_warriors 
											stacks = 4
										}
										men_at_arms = {
											type = orc_warriors 
											stacks = 10
										}
										location = capital_province
										inheritable = no
										name = orc_event_troops
										}
									}
									1 = {spawn_army = {
										men_at_arms = {
											type = serpent_guard 
											stacks = 8
										}
										men_at_arms = {
											type = desert_javelineers
											stacks = 8
										}
										men_at_arms = {
											type = haradrim_radiers
											stacks = 4
										}
										men_at_arms = {
											type = war_mumak
											stacks = 2
										}
										location = capital_province
										inheritable = no
										name = haradrim_event_troops
										}
									}
								}
							}
					}
				}
			  
			}	      
		}
	}
}
cast_mark_of_war = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		switch = {
			trigger = var:ritual_location
			
			flag:sacred_place = {
				random_list = {
					25 = {	# Failure
						desc = evil.0022.a
						modifier = {add = var:low_mod}
						trigger_event = {
							id = evil.0122
							days = { 15 30 }
						}
						
					}
					50 = {	# Success
						desc = evil.0023.a
						trigger_event = {
							id = evil.0123
							days = { 15 30 }
						}
						if = {
							limit = {
								OR = {
									root.faith = faith:lidless_eye
									root.faith = faith:sons_of_sauron
									root.faith = faith:red_eye_cult
								}
							}
							add_character_modifier = {
								modifier = red_eye_mark_modifier
								years = 4
							}
						}
						else_if = {
							limit = {root.faith = faith:white_hand_cult}
							add_character_modifier = {
								modifier = great_white_hand_mark_modifier
								years = 4
							}
						}
						else = {
							add_character_modifier = {
								modifier = great_invigoreted_troops_modifier
								years = 4
							}
						}	
					}
					25 = {	# Critical Succes
						desc = evil.0024.a
						modifier = {add = var:high_mod}
						trigger_event = {
							id = evil.0124
							days = { 15 30 }
						}
						if = {
							limit = {
								OR = {
									root.faith = faith:lidless_eye
									root.faith = faith:sons_of_sauron
									root.faith = faith:red_eye_cult
								}
							}
							add_character_modifier = {
								modifier = red_eye_mark_modifier
								years = 5
							}
						}
						else_if = {
							limit = {root.faith = faith:white_hand_cult}
							add_character_modifier = {
								modifier = great_white_hand_mark_modifier
								years = 5
							}
						}
						else = {
							add_character_modifier = {
								modifier = great_invigoreted_troops_modifier
								years = 5
							}
						}	
					}
				}
			}
			flag:wilds = {
				random_list = {
					25 = {	# Critical Failure
						desc = evil.0021.a
						trigger_event = {
							id = evil.0121
							days = { 15 30 }
						}
					}
					75 = {	# Failure
						desc = evil.0022.a
						trigger_event = {
							id = evil.0122
							days = { 15 30 }
						}
					}
					75 = {	# Succes
						desc = evil.0023.a
						trigger_event = {
							id = evil.0123
							days = { 15 30 }
						}
						if = {
							limit = {
								OR = {
									root.faith = faith:lidless_eye
									root.faith = faith:sons_of_sauron
									root.faith = faith:red_eye_cult
								}
							}
							add_character_modifier = {
								modifier = red_eye_mark_modifier
								years = 4
							}
						}
						else_if = {
							limit = {root.faith = faith:white_hand_cult}
							add_character_modifier = {
								modifier = great_white_hand_mark_modifier
								years = 4
							}
						}
						else = {
							add_character_modifier = {
								modifier = great_invigoreted_troops_modifier
								years = 4
							}
						}	
					}
					25 = {	# Critical Succes
						desc = evil.0024.a
						trigger_event = {
							id = evil.0124
							days = { 15 30 }
						}
						if = {
							limit = {
								OR = {
									root.faith = faith:lidless_eye
									root.faith = faith:sons_of_sauron
									root.faith = faith:red_eye_cult
								}
							}
							add_character_modifier = {
								modifier = red_eye_mark_modifier
								years = 5
							}
						}
						else_if = {
							limit = {root.faith = faith:white_hand_cult}
							add_character_modifier = {
								modifier = great_white_hand_mark_modifier
								years = 5
							}
						}
						else = {
							add_character_modifier = {
								modifier = great_invigoreted_troops_modifier
								years = 5
							}
						}	
					}
				}
			}
			flag:home = {
				random_list = {
					50 = {	# Failure
						desc = evil.0022.a
						trigger_event = {
							id = evil.0122
							days = { 15 30 }
						}
					}
					50 = {	# Succes
						desc = evil.0023.a
						trigger_event = {
							id = evil.0123
							days = { 15 30 }
						}
						if = {
							limit = {
								OR = {
									root.faith = faith:lidless_eye
									root.faith = faith:sons_of_sauron
									root.faith = faith:red_eye_cult
								}
							}
							add_character_modifier = {
								modifier = red_eye_mark_modifier
								years = 4
							}
						}
						else_if = {
							limit = {root.faith = faith:white_hand_cult}
							add_character_modifier = {
								modifier = great_white_hand_mark_modifier
								years = 4
							}
						}
						else = {
							add_character_modifier = {
								modifier = great_invigoreted_troops_modifier
								years = 4
							}
						}	
					}
				}
			  
			}
		}	
	}
}

cast_assemble_the_warchiefs = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}

	}
}
cast_rise_the_dead = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_rise_the_dead
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_rise_the_dead
				}
				spawn_army = {
					men_at_arms = {
						type = unburied_wights
						stacks = 17
					}
					men_at_arms = {
						type = unburied_wights
						stacks = 17
					}
					men_at_arms = {
						type = blighted_trappers 
						stacks = 10
					}
					location = capital_province
					inheritable = no
					uses_supply = no
					name = wight_event_troops
				}
			}
		}
	}
}
cast_invoke_watchers = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_invoke_watchers
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_invoke_watchers
				}
				capital_province = {
					add_province_modifier = {
						modifier = watchers_modifier
						years = 5
					}
				}
			}
		}
	}
}
cast_summon_being_of_darkness = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_summon_being_of_darkness
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_summon_being_of_darkness
				}
				add_character_modifier = {
					modifier = fell_beast_mount_modifier
				}
				if = {
					limit = {has_character_modifier = drake_mount_modifier}
					remove_character_modifier = drake_mount_modifier
				}
			}
		}
	}
}
cast_cracks_of_the_earth = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_cracks_of_the_earth
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_cracks_of_the_earth
				}
				capital_county = {
					if = {
						limit = {
							holder.top_liege = root.liege
							NOT = {has_county_modifier = cracks_of_the_earth_modifier}
						}
						add_county_modifier = {
							modifier = cracks_of_the_earth_modifier
							years = 5
						}
					}
					every_neighboring_county = {
						if = {
							limit = {
								holder.top_liege = root.liege
								NOT = {has_county_modifier = cracks_of_the_earth_modifier}
							}
							add_county_modifier = {
								modifier = cracks_of_the_earth_modifier
								years = 5
							}
						}
					}
				}
			}
		}
	}
}
cast_dark_vitality = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_dark_vitality
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_dark_vitality
				}
				add_character_modifier = {
					modifier = dark_vitality_modifier
					years = 10
				}
			}
		}
	}
}
cast_words_of_power = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_words_of_power
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_words_of_power
				}
				random_character_war = {
					if = {
						limit = {root = {is_at_war_as_attacker = yes}}
						casus_belli = {
							every_target_title = {
								if = {limit = {title_capital_county = {holder.top_liege = root.liege}}
									random_de_jure_county_holder = {
										limit = {
											top_liege = {is_at_war_with = root.liege}
										}
										capital_county = {
											  every_county_province = {
												if = {
													limit = {has_holding_type = castle_holding}
													add_province_modifier = {
														modifier = words_of_power_modifier
														years = 2
													}
												}	
											}
										}
									}
								}
								else = {
									title_capital_county = {
										if = {
											limit = {
												NOT = {holder.top_liege = root.liege}
											}
											every_county_province = {
												if = {
													limit = {has_holding_type = castle_holding}
													add_province_modifier = {
														modifier = words_of_power_modifier
														years = 2
													}
												}	
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
}
cast_forge_morgul_weapons = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_forge_morgul_weapons
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_forge_morgul_weapons
				}
				add_character_modifier = {
					modifier = morgul_weapons
					years = 5
				}
			}
		}
	}
}
cast_purse_them_relentlessly = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_purse_them_relentlessly
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_purse_them_relentlessly
				}
				add_character_modifier = {
					modifier = nazgul_pursue_modifier
					years = 5
				}
			}
		}
	}
}
cast_black_breath = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_black_breath
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_black_breath
				}
				if = {
					limit = {is_at_war = yes}
					random_character_war = {
						casus_belli = {
							every_target_title = {
								if = {limit = {title_capital_county = {holder.top_liege = root.liege}}
									random_de_jure_county_holder = {
										limit = {
											top_liege = {is_at_war_with = root.liege}
										}
										add_character_modifier = {
											modifier = black_breath_modifier
											years = 5
										}
										if = {limit = {NOT = {this = this.top_liege}}
											this.top_liege = {
												add_character_modifier = {
													modifier = black_breath_modifier
													years = 5
												}
											}
										}
									}
								}
								else = {
									title_capital_county = {
										if = {
											limit = {
												NOT = {holder.top_liege = root.liege}
											}
											this.holder = {
												add_character_modifier = {
													modifier = black_breath_modifier
													years = 5
												}
											}
											if = {limit = {NOT = {this.holder = this.holder.top_liege}}
												this.holder.top_liege = {
													add_character_modifier = {
														modifier = black_breath_modifier
														years = 5
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
				else = {
					random_character_to_title_neighboring_and_across_water_county = {
						if = {
							limit = {
								NOT = {this.holder.top_liege = root.liege}
							}
							this.holder = {
								add_character_modifier = {
									modifier = black_breath_modifier
									years = 5
								}
							}
							if = {limit = {NOT = {this.holder = this.holder.top_liege}}
								this.holder.top_liege = {
									add_character_modifier = {
										modifier = black_breath_modifier
										years = 5
									}
								}
							}
						}
					}
				}
			}
		}
	}
}
cast_nazgul_restoration = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_nazgul_restoration
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_nazgul_restoration
				}
			}
		}
	}
}
cast_ambassador_of_darkness = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_ambassador_of_darkness
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_ambassador_of_darkness
				}
				add_character_modifier = {
					modifier = ambassador_of_darkness_modifier
					years = 5
				}
			}
		}
	}
}
cast_shapeshifting = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_shapeshifting
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_shapeshifting
				}
				add_character_modifier = {
					modifier = shapeshifter_modifier
					years = 1
				}
			}
		}
	}
}
cast_reveal_the_secrets = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_reveal_the_secrets
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_reveal_the_secrets
				}
				every_targeting_scheme = {
					random_scheme_agent = {
						save_scope_as = righty
					}
					scheme_owner = {
						save_scope_as = schemer
					}
					root = {
						add_hook = {
							type = manipulation_hook
								target = scope:schemer
						}
					}
					if = {
						limit = {is_scheme_exposed = no}
						expose_scheme = yes
					}
				}
				if = {
					limit = { exists = scope:righty }
					add_hook = {
						type = fabrication_hook
						target = scope:righty
					}
					expose_scheme_agent = scope:righty
				}
			}
		}
	}
}
cast_cast_the_darkness = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_cast_the_darkness
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_cast_the_darkness
				}
				every_character_to_title_neighboring_and_across_water_county = {
					if = {
						limit = {
							NOR = {holder.top_liege = root.liege
								   has_county_modifier = darkness_modifier}
						}
						add_county_modifier = {
							modifier = darkness_modifier
							years = 5
						}
					}
				}
			}
		}
	}
}
cast_abnormal_winter = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_abnormal_winter
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_abnormal_winter
				}
				every_neighboring_and_across_water_top_liege_realm_owner = {
					save_scope_as = enemy
					every_living_character = {
						if = {
							limit = {this.top_liege = scope:enemy}
							add_character_modifier = {
								modifier = abnormal_winter_character_modifier
								years = 5
							}
						}
					}
					every_county = {
						if = {
							limit = {this.holder.top_liege = scope:enemy
									NOT = {has_county_modifier = abnormal_winter_modifier}}
							add_county_modifier = {
								modifier = abnormal_winter_modifier
								years = 5
							}
						}
					}
				}
			}
		}
	}
}
cast_the_plague = {
	is_valid = {
		NOT = { var:ritual_location = flag:no_location }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_1 }
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 4
			}
		}
		else = {
			add_character_modifier = {
				modifier = practiced_sorcery_recently
				years = 5
			}
		}
		random_list = {
			100 = {
				trigger_event = ritual_success.1001
				modifier = {
					add = {
						value = success_the_plague
						multiply = -1
					}
				}
			}
			0 = {
				trigger_event = ritual_success.1000
				modifier = {
					add = success_the_plague
				}
				random_neighboring_and_across_water_top_liege_realm_owner = {
					limit = {
						religion = { is_in_family = rf_eruhini }
						realm_size > 50
					}
					alternative_limit = {
						religion = { is_in_family = rf_eruhini }
					}
					alternative_limit = {
						NOT = { religion = { is_in_family = rf_forcesofevil } }
					}
					add_to_list = plague_targets
					capital_county = {
						if = {
							limit = {
								NOT = {has_county_modifier = the_plague_modifier}
							}
							add_county_modifier = {
								modifier = the_plague_modifier
								years = 5
							}
						}
					}
					random_realm_county = {
						limit = {
							NOT = {has_county_modifier = the_plague_modifier}
						}
						holder = {
							add_to_list = plague_targets
						}
						add_county_modifier = {
							modifier = the_plague_modifier
							years = 5
						}
					}
					random_realm_county = {
						limit = {
							NOT = {has_county_modifier = the_plague_modifier}
						}
						holder = {
							add_to_list = plague_targets
						}
						add_county_modifier = {
							modifier = the_plague_modifier
							years = 5
						}
					}
					every_in_list = {
						list = plague_targets
						every_courtier_or_guest = {
							random_list = {
								20 = {contract_disease_notify_effect = { DISEASE = pneumonic} }
								15 = {contract_disease_notify_effect = { DISEASE = smallpox} }
								14 = {contract_disease_notify_effect = { DISEASE = typhus} }
								1 = {contract_disease_notify_effect = { DISEASE = bubonic_plague} }
								0 = {
									compare_modifier = {
										value = this.health
										multiplier = 5
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

set_up_locations_for_yourself = {
	effect = {
		set_variable = {
			name = ritual_location
			value = flag:no_location
		}
		clear_variable_list = possible_sorcery_locations
		set_up_holy_sites_for_selection_effect = yes
		add_to_variable_list = {
			name = possible_sorcery_locations
			target = flag:home
		}
		add_to_variable_list = {
			name = possible_sorcery_locations
			target = flag:wilds
		}
		if = {
			limit = { scope:holy_site_1.holder = this }
			add_to_variable_list = {
				name = possible_sorcery_locations
				target = flag:holy_site_1
			}
			set_variable = {
				name = holy_site_1
				value = scope:holy_site_1
			}
		}
		if = {
			limit = { scope:holy_site_2.holder = this }
			add_to_variable_list = {
				name = possible_sorcery_locations
				target = flag:holy_site_2
			}
			set_variable = {
				name = holy_site_2
				value = scope:holy_site_2
			}
		}
		if = {
			limit = { scope:holy_site_3.holder = this }
			add_to_variable_list = {
				name = possible_sorcery_locations
				target = flag:holy_site_3
			}
			set_variable = {
				name = holy_site_3
				value = scope:holy_site_3
			}
		}
		if = {
			limit = { scope:holy_site_4.holder = this }
			add_to_variable_list = {
				name = possible_sorcery_locations
				target = flag:holy_site_4
			}
			set_variable = {
				name = holy_site_4
				value = scope:holy_site_4
			}
		}
		if = {
			limit = { scope:holy_site_5.holder = this }
			add_to_variable_list = {
				name = possible_sorcery_locations
				target = flag:holy_site_5
			}
			set_variable = {
				name = holy_site_5
				value = scope:holy_site_5
			}
		}
	}
}

location_home = {
	effect = {
		set_variable = {
			name = ritual_location
			value = flag:home
		}
	}
}

location_wilds = {
	effect = {
		set_variable = {
			name = ritual_location
			value = flag:wilds
		}
	}
}

location_holy_site_1 = {
	effect = {
		set_variable = {
			name = ritual_location
			value = flag:holy_site_1
		}
	}
}

location_holy_site_2 = {
	effect = {
		set_variable = {
			name = ritual_location
			value = flag:holy_site_2
		}
	}
}

location_holy_site_3 = {
	effect = {
		set_variable = {
			name = ritual_location
			value = flag:holy_site_3
		}
	}
}

location_holy_site_4 = {
	effect = {
		set_variable = {
			name = ritual_location
			value = flag:holy_site_4
		}
	}
}

location_holy_site_5 = {
	effect = {
		set_variable = {
			name = ritual_location
			value = flag:holy_site_5
		}
	}
}

ritual_costs_sgui = {
	is_valid = {
		OR = {
			AND = {
				NOT = { var:ritual_location = flag:holy_site_4 }
				piety >= spell_cost
			}
			AND = {
				var:ritual_location = flag:holy_site_4
				gold >= spell_cost
			}
		}
		NOT = { has_character_modifier = practiced_sorcery_recently }
	}
	effect = {
		if = {
			limit = { var:ritual_location = flag:holy_site_4 }
			remove_short_term_gold = spell_cost
		}
		else = {
			add_piety = negative_spell_cost
		}
	}
}