siro_special_slot_map = {
	effect = {
		if = {
			limit = {
				trigger_if = {
					limit = { exists = global_var:custom_map_mode }
					NOT = { global_var:custom_map_mode = flag:siro_special_slot_map }
				}
			}
			set_global_variable = {
				name = custom_map_mode_changing
				value = 1
			}
			set_global_variable = {
				name = custom_map_mode
				value = flag:siro_special_slot_map
			}
			if = {
				every_province = {
					limit = { 
						OR = {
							has_special_building = yes
							has_special_building_slot = yes
						}
					}
					set_barony_sp_values = yes
				}
			}
			
			every_barony = {
				if = {
					limit = { 
						title_province = { 
							has_special_building = yes
							has_building_with_flag = fully_upgraded
						}
					}
					set_color_from_title = title:d_siro_map_special_upgraded
				}
				else_if = {
					limit = { 
						title_province = { 
							has_special_building = yes
						}
					}
					set_color_from_title = title:d_siro_map_special
				}
				else_if = {
					limit = { 
						title_province = { 
							has_special_building_slot = yes
						}
					}
					set_color_from_title = title:d_siro_map_special_slot
				}
				else = {
					set_color_from_title = title:d_siro_map_base
				}
			}
			remove_global_variable = custom_map_mode_changing
		}
	}
	is_shown = {
		trigger_if = {
			limit = { exists = global_var:custom_map_mode }
			global_var:custom_map_mode = flag:siro_special_slot_map
		}
	}
	is_valid = {
		NOT = { exists = global_var:custom_map_mode_changing }
	}
}

alignment_map = {
	effect = {
		if = {
			limit = {
				trigger_if = {
					limit = { exists = global_var:custom_map_mode }
					NOT = { global_var:custom_map_mode = flag:alignment_map }
				}
			}
			set_global_variable = {
				name = custom_map_mode_changing
				value = 1
			}
			set_global_variable = {
				name = custom_map_mode
				value = flag:alignment_map
			}
			every_county = {
				if = {
					# Good
					limit = {
						holder.religion = {
							OR = { 
								is_in_family = rf_freepeoples
								is_in_family = rf_eruhini
							}
						}
					}
					every_county_province = { barony = { set_color_from_title = title:d_alignment_map_good } }
				}
				else_if = {
					# Good Leaning
					limit = {
						holder.faith = {
							has_doctrine = doctrine_echoes_of_the_ainur
						}
					}
					every_county_province = { barony = { set_color_from_title = title:d_alignment_map_goodish } }
				}
				else_if = {
					# Neutral
					limit = {
						OR = {
							holder.faith = {
								has_doctrine = doctrine_a_people_apart
							}
							holder.religion = {
								is_in_family = rf_pagan
							}
						}
					}
					every_county_province = { barony = { set_color_from_title = title:d_alignment_map_neutral } }
				}
				else_if = {
					# Evilish
					limit = {
						holder.faith = {
							has_doctrine = doctrine_dominion_of_the_dark
						}
					}
					every_county_province = { barony = { set_color_from_title = title:d_alignment_map_evilish } }
				}
				else_if = {
					# Evil
					limit = {
						holder.religion = {
							is_in_family = rf_forcesofevil
						}
					}
					every_county_province = { barony = { set_color_from_title = title:d_alignment_map_evil } }
				}
			}
			remove_global_variable = custom_map_mode_changing
		}
	}
	is_shown = {
		trigger_if = {
			limit = { exists = global_var:custom_map_mode }
			global_var:custom_map_mode = flag:alignment_map
		}
	}
	is_valid = {
		NOT = { exists = global_var:custom_map_mode_changing }
	}
}

tributaries_map = {
	effect = {
		if = {
			limit = {
				trigger_if = {
					limit = { exists = global_var:custom_map_mode }
					NOT = { global_var:custom_map_mode = flag:tributaries_map }
				}
			}
			set_global_variable = {
				name = custom_map_mode_changing
				value = 1
			}
			set_global_variable = {
				name = custom_map_mode
				value = flag:tributaries_map
			}
			every_barony = {
				set_color_from_title = title:d_tributary_map_base
			}
			every_county = {
				if = {
					# Tributary States (CUSTOM_TRIBUTARY_MAP_ANY_TRIBUTARY_STATES)	
					limit = {
						holder = {
							OR = {
								AND = {
									exists = var:my_suzerain
									exists = var:tributary_type
									var:tributary_type = flag:non_permanent_tributary
								}
								any_liege_or_above = {
									AND = {
										exists = var:my_suzerain
										exists = var:tributary_type
										var:tributary_type = flag:non_permanent_tributary
									}
								}
							}
						}
					}
					every_county_province = { barony = { set_color_from_title = title:d_tributary_map_tributary_state } }
				}
				else_if = {
					# Client States (CUSTOM_TRIBUTARY_MAP_ANY_CLIENT_STATES)	
					limit = {
						holder = {
							OR = {
								AND = {
									exists = var:my_suzerain
									exists = var:tributary_type
									var:tributary_type = flag:permanent_tributary
								}
								any_liege_or_above = {
									AND = {
										exists = var:my_suzerain
										exists = var:tributary_type
										var:tributary_type = flag:permanent_tributary
									}
								}
							}
						}
					}
					every_county_province = { barony = { set_color_from_title = title:d_tributary_map_client_state } }
				}
				else_if = {
					# Protectorates (CUSTOM_TRIBUTARY_MAP_ANY_PROTECTORATES)
					limit = {
						holder = {
							OR = {
								AND = {
									exists = var:my_suzerain
									exists = var:tributary_type
									var:tributary_type = flag:tributary_protectorate
								}
								any_liege_or_above = {
									AND = {
										exists = var:my_suzerain
										exists = var:tributary_type
										var:tributary_type = flag:tributary_protectorate
									}
								}
							}
						}
					}
					every_county_province = { barony = { set_color_from_title = title:d_tributary_map_protectorate } }
				}
				else_if = {
					# Suzerains (CUSTOM_TRIBUTARY_MAP_ANY_SUZERAIN)	
					limit = {
						holder = {
							OR = {
								AND = {
									has_variable_list = all_tributaries
									any_in_list = {
										variable = all_tributaries
										exists = var:overlord_type
										var:overlord_type = flag:suzerain
									}
								}
								any_liege_or_above = {
									AND = {
										has_variable_list = all_tributaries
										any_in_list = {
											variable = all_tributaries
											exists = var:overlord_type
											var:overlord_type = flag:suzerain
										}
									}
								}
							}
						}
					}
					every_county_province = { barony = { set_color_from_title = title:d_tributary_map_suzerain } }
				}
				else_if = {
					# Protectors (CUSTOM_TRIBUTARY_MAP_ANY_PROTECTOR)	
					limit = {
						holder = {
							OR = {
								AND = {
									has_variable_list = all_tributaries
									any_in_list = {
										variable = all_tributaries
										exists = var:overlord_type
										var:overlord_type = flag:protector
									}
								}
								any_liege_or_above = {
									AND = {
										has_variable_list = all_tributaries
										any_in_list = {
											variable = all_tributaries
											exists = var:overlord_type
											var:overlord_type = flag:protector
										}
									}
								}
							}
						}
					}
					every_county_province = { barony = { set_color_from_title = title:d_tributary_map_protector } }
				}
			}
			remove_global_variable = custom_map_mode_changing
		}
	}
	is_shown = {
		trigger_if = {
			limit = { exists = global_var:custom_map_mode }
			global_var:custom_map_mode = flag:tributaries_map
		}
	}
	is_valid = {
		NOT = { exists = global_var:custom_map_mode_changing }
	}
}

racial_homelands_map = {
	effect = {
		if = {
			limit = {
				trigger_if = {
					limit = { exists = global_var:custom_map_mode }
					NOT = { global_var:custom_map_mode = flag:racial_homelands_map }
				}
			}
			set_global_variable = {
				name = custom_map_mode_changing
				value = 1
			}
			set_global_variable = {
				name = custom_map_mode
				value = flag:racial_homelands_map
			}
			every_barony = {
				set_color_from_title = title:d_tributary_map_base
			}
			every_county = {
				if = {
					limit = {
						has_county_modifier = elven_homeland_county_modifier
					}
					every_county_province = { barony = { set_color_from_title = title:d_elven_homelands } }
				}
			}
			remove_global_variable = custom_map_mode_changing
		}
	}
	is_shown = {
		trigger_if = {
			limit = { exists = global_var:custom_map_mode }
			global_var:custom_map_mode = flag:racial_homelands_map
		}
	}
	is_valid = {
		NOT = { exists = global_var:custom_map_mode_changing }
	}
}

trade_routes_map = {
	effect = {
		if = {
			limit = {
				trigger_if = {
					limit = { exists = global_var:custom_map_mode }
					NOT = { global_var:custom_map_mode = flag:trade_routes_map }
				}
			}
			set_global_variable = {
				name = custom_map_mode_changing
				value = 1
			}
			set_global_variable = {
				name = custom_map_mode
				value = flag:trade_routes_map
			}
			every_barony = {
				set_color_from_title = title:d_tributary_map_base
			}
			every_province = {
				if = {
					# Good
					limit = {
						has_province_modifier = rhun_road_province_modifier
					}
					barony = { set_color_from_title = title:d_tributary_map_tributary_state }
				}
			}
			remove_global_variable = custom_map_mode_changing
		}
	}
	is_shown = {
		trigger_if = {
			limit = { exists = global_var:custom_map_mode }
			global_var:custom_map_mode = flag:trade_routes_map
		}
	}
	is_valid = {
		NOT = { exists = global_var:custom_map_mode_changing }
	}
}

relics_map = {
	effect = {
		if = {
			limit = {
				trigger_if = {
					limit = { exists = global_var:custom_map_mode }
					NOT = { global_var:custom_map_mode = flag:relics_map }
				}
			}
			set_global_variable = {
				name = custom_map_mode_changing
				value = 1
			}
			set_global_variable = {
				name = custom_map_mode
				value = flag:relics_map
			}
			every_barony = {
				set_color_from_title = title:d_tributary_map_base
			}
			every_artifact = {
				trigger = {
					is_unique = yes
				}
				artifact_owner.location.barony = { set_color_from_title = title:d_unique_artifacts }
			}
			remove_global_variable = custom_map_mode_changing
		}
	}
	is_shown = {
		trigger_if = {
			limit = { exists = global_var:custom_map_mode }
			global_var:custom_map_mode = flag:relics_map
		}
	}
	is_valid = {
		NOT = { exists = global_var:custom_map_mode_changing }
	}
}