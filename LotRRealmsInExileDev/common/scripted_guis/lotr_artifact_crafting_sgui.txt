###############################
### Artifact related sGUI's ###
###############################

# Determines if player can open crafting GUI
can_craft_artifacts = {
	is_shown = {
		always = yes
	}
	
	is_valid = {
		has_trait = lifestyle_artifact_crafting
		NOT = { culture = culture:wastelands }
	}
}

# Clears all appropriate variables from the character
select_no_artifact_type = {
	is_valid = {
		has_variable = artifact_craft
	}
	effect = {
		debug_log = " Artifact Var removed "
		remove_variable = artifact_craft
		remove_variable = used_material
		remove_variable = used_gem
		remove_variable = base_stats_modifiers

		random_owned_story = {
			limit = { story_type = story_cycle_store_artifact_crafting_variables }
			end_story = yes
		}
		
		remove_variable = diplomacy_val
		remove_variable = martial_val
		remove_variable = intrigue_val
		remove_variable = stewardship_val
		remove_variable = learning_val
		remove_variable = prowess_val

		clear_variable_list = artifact_crafting_modifiers
	}
}

# Create a 'story' to store variables
create_variable_storage = {
	effect = {
		create_story = {
			type = story_cycle_store_artifact_crafting_variables
		}
	}
}

## Applies a var to a character to determine what TYPE of artifact he is crafting
select_weapon_artifact_type = {
	effect = {
		debug_log = " Weapon Var added "
		set_variable = {
			name = artifact_craft
			value = flag:weapon_artifact
		}
		remove_pre_selected_material = yes
	}
}
select_armor_artifact_type = {
	effect = {
		debug_log = " Armor Var added "
		set_variable = {
			name = artifact_craft
			value = flag:armor_artifact
		}
		remove_pre_selected_material = yes
	}
}
select_regalia_artifact_type = {
	effect = {
		debug_log = " Regalia Var added "
		set_variable = {
			name = artifact_craft
			value = flag:regalia_artifact
		}
		remove_pre_selected_material = yes
	}
}
select_helmet_artifact_type = {
	effect = {
		debug_log = " Helmet Var added "
		set_variable = {
			name = artifact_craft
			value = flag:helmet_artifact
		}
		remove_pre_selected_material = yes
	}
}
select_trinket_artifact_type = {
	effect = {
		debug_log = " Trinket Var added "
		set_variable = {
			name = artifact_craft
			value = flag:trinket_artifact
		}
		remove_pre_selected_material = yes
	}
}

#######################################
### Material (Metal) related sGUI's ###
#######################################

## Checks whether character can use a certain material (checks county modifiers)
mithril_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_mithril_province_modifier
		}
	}
}
gold_crafting_county = {
	is_valid = { 
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_gold_province_modifier
		}
	}
}
silver_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_silver_province_modifier
		}
	}
}
steel_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_iron_province_modifier
		}
	}
}
iron_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_iron_province_modifier
		}
	}
}
bronze_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_copper_province_modifier
		}
	}
}
copper_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_copper_province_modifier
		}
	}
}
tin_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_tin_province_modifier
		}
	}
}
lead_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_lead_province_modifier
		}
	}
}

## Adds variable to character to determine what he is using to craft artifact with
mithril_crafting_material = {
	effect = {
		debug_log = " Mithril Var added "
		remove_artifact_crafting_material_var = yes
		set_variable = {
			name = used_material
			value = flag:mithril_crafting
		}
		add_artifact_crafting_material_var = yes
	}
}
gold_crafting_material = {
	effect = {
		debug_log = " Gold Var added "
		remove_artifact_crafting_material_var = yes
		set_variable = {
			name = used_material
			value = flag:gold_crafting
		}
		add_artifact_crafting_material_var = yes
	}
}
silver_crafting_material = {
	effect = {
		debug_log = " Silver Var added "
		remove_artifact_crafting_material_var = yes
		set_variable = {
			name = used_material
			value = flag:silver_crafting
		}
		add_artifact_crafting_material_var = yes
	}
}
steel_crafting_material = {
	effect = {
		debug_log = " Steel Var added "
		remove_artifact_crafting_material_var = yes
		set_variable = {
			name = used_material
			value = flag:steel_crafting
		}
		add_artifact_crafting_material_var = yes
	}
}
iron_crafting_material = {
	effect = {
		debug_log = " Iron Var added "
		remove_artifact_crafting_material_var = yes
		set_variable = {
			name = used_material
			value = flag:iron_crafting
		}
		add_artifact_crafting_material_var = yes
	}
}
bronze_crafting_material = {
	effect = {
		debug_log = " Bronze Var added "
		remove_artifact_crafting_material_var = yes
		set_variable = {
			name = used_material
			value = flag:bronze_crafting
		}
		add_artifact_crafting_material_var = yes
	}
}
copper_crafting_material = {
	effect = {
		debug_log = " Copper Var added "
		remove_artifact_crafting_material_var = yes
		set_variable = {
			name = used_material
			value = flag:copper_crafting
		}
		add_artifact_crafting_material_var = yes
	}
}
tin_crafting_material = {
	effect = {
		debug_log = " Tin Var added "
		remove_artifact_crafting_material_var = yes
		set_variable = {
			name = used_material
			value = flag:tin_crafting
		}
		add_artifact_crafting_material_var = yes
	}
}
lead_crafting_material = {
	effect = {
		debug_log = " Lead Var added "
		remove_artifact_crafting_material_var = yes
		set_variable = {
			name = used_material
			value = flag:lead_crafting
		}
		add_artifact_crafting_material_var = yes
	}
}

#######################################
### Material (Gems) related sGUI's ###
#######################################

## Checks whether character can use a certain material (checks county modifiers)
diamond_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_diamond_province_modifier
		}
	}
}
emerald_crafting_county = {
	is_valid = { 
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_emerald_province_modifier
		}
	}
}
sapphire_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_sapphire_province_modifier
		}
	}
}
ruby_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_ruby_province_modifier
		}
	}
}
amethyst_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_amethyst_province_modifier
		}
	}
}
onyx_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_onyx_province_modifier
		}
	}
}
peridot_crafting_county = {
	is_valid = {
		contains_prospecting_modifier = {
			PROSPECTING_MODIFIER = prospecting_peridot_province_modifier
		}
	}
}
quartz_crafting_county = {
	is_valid = {
		# contains_prospecting_modifier = {
		# 	PROSPECTING_MODIFIER = prospecting_quartz_province_modifier
		# }
		always = yes
	}
}

## Adds variable to character to determine what he is using to craft artifact with
diamond_crafting_material = {
	effect = {
		debug_log = " Diamond Var added "
		remove_artifact_crafting_gem_var = yes
		set_variable = {
			name = used_gem
			value = flag:diamond_crafting
		}
		add_artifact_crafting_gem_var = yes
	}
}
emerald_crafting_material = {
	effect = {
		debug_log = " Emerald Var added "
		remove_artifact_crafting_gem_var = yes
		set_variable = {
			name = used_gem
			value = flag:emerald_crafting
		}
		add_artifact_crafting_gem_var = yes
	}
}
sapphire_crafting_material = {
	effect = {
		debug_log = " Sapphire Var added "
		remove_artifact_crafting_gem_var = yes
		set_variable = {
			name = used_gem
			value = flag:sapphire_crafting
		}
		add_artifact_crafting_gem_var = yes
	}
}
ruby_crafting_material = {
	effect = {
		debug_log = " Ruby Var added "
		remove_artifact_crafting_gem_var = yes
		set_variable = {
			name = used_gem
			value = flag:ruby_crafting
		}
		add_artifact_crafting_gem_var = yes
	}
}
amethyst_crafting_material = {
	effect = {
		debug_log = " Amethyst Var added "
		remove_artifact_crafting_gem_var = yes
		set_variable = {
			name = used_gem
			value = flag:amethyst_crafting
		}
		add_artifact_crafting_gem_var = yes
	}
}
onyx_crafting_material = {
	effect = {
		debug_log = " Onyx Var added "
		remove_artifact_crafting_gem_var = yes
		set_variable = {
			name = used_gem
			value = flag:onyx_crafting
		}
		add_artifact_crafting_gem_var = yes
	}
}
peridot_crafting_material = {
	effect = {
		debug_log = " Peridot Var added "
		remove_artifact_crafting_gem_var = yes
		set_variable = {
			name = used_gem
			value = flag:peridot_crafting
		}
		add_artifact_crafting_gem_var = yes
	}
}
quartz_crafting_material = {
	effect = {
		debug_log = " Quartz Var added "
		remove_artifact_crafting_gem_var = yes
		set_variable = {
			name = used_gem
			value = flag:quartz_crafting
		}
		add_artifact_crafting_gem_var = yes
	}
}

##################################
### Base Stat Modifiers sGUI's ###
##################################

artifact_diplomacy_positive = {
	is_valid = {
		valid_decrease_base_stat_modifier = { BASE_STAT = diplomacy_val }
	}
	effect = {
		artifact_crafting_modifier_effect_increase = { 
			VALUE = diplomacy_val 
			NAME = artifact_diplomacy
		}
	}
}
artifact_diplomacy_negative = {
	is_valid = {
		valid_increase_base_stat_modifier = { BASE_STAT = diplomacy_val }
	}
	effect = {
		artifact_crafting_modifier_effect_decrease = { 
			VALUE = diplomacy_val 
			NAME = artifact_diplomacy
		}
	}
}

artifact_martial_positive = {
	is_valid = {
		valid_decrease_base_stat_modifier = { BASE_STAT = martial_val }
	}
	effect = {
		artifact_crafting_modifier_effect_increase = {
			VALUE = martial_val 
			NAME = artifact_martial
		}
	}
}
artifact_martial_negative = {
	is_valid = {
		valid_increase_base_stat_modifier = { BASE_STAT = martial_val }
	}
	effect = {
		artifact_crafting_modifier_effect_decrease = { 
			VALUE = martial_val 
			NAME = artifact_martial
		}
	}
}

artifact_stewardship_positive = {
	is_valid = {
		valid_decrease_base_stat_modifier = { BASE_STAT = stewardship_val }
	}
	effect = {
		artifact_crafting_modifier_effect_increase = { 
			VALUE = stewardship_val 
			NAME = artifact_stewardship
		}
	}
}
artifact_stewardship_negative = {
	is_valid = {
		valid_increase_base_stat_modifier = { BASE_STAT = stewardship_val }
	}
	effect = {
		artifact_crafting_modifier_effect_decrease = { 
			VALUE = stewardship_val 
			NAME = artifact_stewardship
		}
	}
}

artifact_intrigue_positive = {
	is_valid = {
		valid_decrease_base_stat_modifier = { BASE_STAT = intrigue_val }
	}
	effect = {
		artifact_crafting_modifier_effect_increase = { 
			VALUE = intrigue_val 
			NAME = artifact_intrigue
		}
	}
}
artifact_intrigue_negative = {
	is_valid = {
		valid_increase_base_stat_modifier = { BASE_STAT = intrigue_val }
	}
	effect = {
		artifact_crafting_modifier_effect_decrease = { 
			VALUE = intrigue_val 
			NAME = artifact_intrigue
		}
	}
}

artifact_learning_positive = {
	is_valid = {
		valid_decrease_base_stat_modifier = { BASE_STAT = learning_val }
	}
	effect = {
		artifact_crafting_modifier_effect_increase = { 
			VALUE = learning_val 
			NAME = artifact_learning
		}
	}
}
artifact_learning_negative = {
	is_valid = {
		valid_increase_base_stat_modifier = { BASE_STAT = learning_val }
	}
	effect = {
		artifact_crafting_modifier_effect_decrease = { 
			VALUE = learning_val 
			NAME = artifact_learning
		}
	}
}

artifact_prowess_positive = {
	is_valid = {
		valid_decrease_base_stat_modifier = { BASE_STAT = prowess_val }
	}
	effect = {
		artifact_crafting_modifier_effect_increase = { 
			VALUE = prowess_val 
			NAME = artifact_prowess
		}
	}
}
artifact_prowess_negative = {
	is_valid = {
		valid_increase_base_stat_modifier = { BASE_STAT = prowess_val }
	}
	effect = {
		artifact_crafting_modifier_effect_decrease = { 
			VALUE = prowess_val
			NAME = artifact_prowess
		}
	}
}

