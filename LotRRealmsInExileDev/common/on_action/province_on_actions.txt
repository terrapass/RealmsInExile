# root: The province in which the building was completed
on_building_completed = {
	effect = {
		root = {
			#Hard working Tradition
			if = {
				limit = {
					culture = {
						has_cultural_parameter = development_gain_on_building_complete
					}
					NOT = {
						county = {
							has_variable = dev_gain_cooldown
						}
					}
				}
				county = {
					change_development_progress_with_overflow = 25
					set_variable = {
						name = dev_gain_cooldown
						value = yes
						days = 365
					}
				}
			}

			#Metal crafting Tradition
			if = {
				limit = {
					culture = {
						has_cultural_parameter = prestige_gain_on_building_complete_in_mountains
					}
					OR = {
						terrain = mountains
						terrain = desert_mountains
					}
				}
				county.holder = {
					add_prestige = medium_prestige_value
				}
			}
			
			#Sacred Mountains Tradition
			if = {
				limit = {
					county.holder.culture = {
						has_cultural_parameter = piety_gain_on_building_complete_in_mountains
					}
					OR = {
						terrain = mountains
						terrain = desert_mountains
					}
				}
				county.holder = {
					add_piety = minor_piety_value
				}
			}
			
			#Sacred Groves Tradition
			if = {
				limit = {
					county.holder.culture = {
						has_cultural_parameter = piety_gain_on_building_complete_in_forest_taiga
					}
					OR = {
						terrain = forest
						terrain = taiga
						terrain = jungle
					}
				}
				county.holder = {
					add_piety = minor_piety_value
				}
			}
			# ispanets: When I finish a building in settlement,
			# I check if all the slots are free
			# If so, we trigger the holding upgrade.

			if = {
				limit = {
					has_holding_type = settlement_holding
					free_building_slots >= 4
				}
				
				if = {
					limit = {					
						county.holder = {
							OR = {
								has_government = feudal_government
								has_government = numenorean_government
								has_government = elven_government
								has_government = despotic_government
							}
						}
					}
					set_holding_type = castle_holding
				}
				else_if = {	
					limit = {
						county.holder = {
							has_government = tribal_government						
						}				
					}
					set_holding_type = tribal_holding
				}
				else_if = {	
					limit = {
						county.holder = {
							has_government = elven_government						
						}				
					}
					set_holding_type = elven_holding
				}
			}
			#Elven building slots number Check
			if = {
				limit = {
					OR = {
						has_building = elven_settlement_03
						has_building = elven_settlement_04
						has_building = elven_settlement_05
					}
					NOT = { building_slots = 6 }
				}
				add_building_slot = 2
			}
			else_if = {						
				limit = {
					OR = {
						has_building = elven_settlement_06
						has_building = elven_settlement_07
					}
					NOT = { building_slots = 8 }
				}
				add_building_slot = 2
			}
		}		
	}
}