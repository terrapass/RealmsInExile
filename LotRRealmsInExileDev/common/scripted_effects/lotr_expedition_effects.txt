title_change_effect = {
	set_holding_type = castle_holding

	create_title_and_vassal_change = {
		type = created
		save_scope_as = change
		add_claim_on_loss = no
	}

	county = {
		set_county_culture = scope:$RULER$.culture
		set_county_faith = scope:$RULER$.faith
			
		change_title_holder = {
			holder = scope:$RULER$
			change = scope:change
		}
	}
	if = {
		limit = { NOT = { scope:$RULER$ ?= scope:host } }
		scope:$RULER$ = { becomes_independent = { change = scope:change } }
	}
	resolve_title_and_vassal_change = scope:change
		
	county = { generate_coa = yes }
	county = { scope:$RULER$ = { set_realm_capital = prev } }
}