### Umbar Decisions ###

decision_harnen_kingdom = {
	title = decision_harnen_kingdom
	picture = "gfx/interface/illustrations/decisions/decision_near_harad_01.dds"
	major = yes
	ai_check_interval = 3
	ai_potential = {
		always = yes
	}
	ai_will_do = {
		base = 100
	}
	selection_tooltip = decision_harnen_kingdom_tooltip
	desc = decision_harnen_kingdom_desc
	confirm_text = decision_harnen_kingdom_confirm
	
	is_shown = {
		is_ruler = yes
		is_landed = yes
		AND = {
			OR = {
				culture = { 
					OR = {	
						has_cultural_pillar = heritage_northern_adunaic
						has_cultural_pillar = heritage_southern_adunaic
						has_cultural_pillar = heritage_dunedain
					}
				}
				AND = {
					lotr_has_numenorean_culture_trigger = yes
					has_primary_title = title:e_numenor_in_exile
				}
			}
			OR = {
				completely_controls = title:c_mirlond
				completely_controls = title:c_ramlond
				completely_controls = title:c_umbar
			}
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:harnen_kingdom_decision
			}
		}
	}
	
	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
	}
	
	is_valid = {
		completely_controls_region = custom_harnendor
		prestige_level >= high_prestige_level
	}
	
	effect = {
		create_title_and_vassal_change = {
			type = created
			save_scope_as = change
			add_claim_on_loss = no
		}
		title:k_mirlond = {
			change_title_holder = {
				holder = root
				change = scope:change
			}
		}
		title:d_forethir = {
			set_de_jure_liege_title = title:k_mirlond
		}
		title:d_ramlond = {
			set_de_jure_liege_title = title:k_mirlond
		}
		title:d_doriant = {
			set_de_jure_liege_title = title:k_mirlond
		}
		resolve_title_and_vassal_change = scope:change
		
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:harnen_kingdom_decision
		}
		title:c_mirlond = {
			change_development_level = 2
		}
		title:d_forethir = {
			change_development_level = 1
		}
		title:d_ramlond = {
			change_development_level = 1
		}
		title:d_doriant = {
			change_development_level = 1
		}
		if = {
			limit = {
				OR = {
					primary_title = {
						OR = {
							de_jure_liege = title:e_gondor_steward
							de_jure_liege.de_jure_liege = title:e_gondor_steward
							de_jure_liege.de_jure_liege.de_jure_liege = title:e_gondor_steward
						}
					}
					has_title = title:e_gondor_steward
				}
			}
			title:k_mirlond = {
				set_de_jure_liege_title = title:e_gondor_steward
			}
		}
		else_if = {
			limit = {
				OR = {
					primary_title = {
						OR = {
							de_jure_liege = title:e_gondor
							de_jure_liege.de_jure_liege = title:e_gondor
							de_jure_liege.de_jure_liege.de_jure_liege = title:e_gondor
						}
					}
					has_title = title:e_gondor
				}
			}
			title:k_mirlond = {
				set_de_jure_liege_title = title:e_gondor
			}
		}
		else_if = {
			limit = {
				OR = {
					primary_title = {
						OR = {
							de_jure_liege = title:e_numenor_colonies
							de_jure_liege.de_jure_liege = title:e_numenor_colonies
							de_jure_liege.de_jure_liege.de_jure_liege = title:e_numenor_colonies
						}
					}
					has_title = title:e_numenor_colonies
				}
			}
			title:k_mirlond = {
					set_de_jure_liege_title = title:e_numenor_colonies
			}
		}
		else_if = {
			limit = {
				OR = {
					primary_title = {
						OR = {
							de_jure_liege = title:e_castamir
							de_jure_liege.de_jure_liege = title:e_castamir
							de_jure_liege.de_jure_liege.de_jure_liege = title:e_castamir
						}
					}
					has_title = title:e_castamir
				}
			}
			title:k_mirlond = {
				set_de_jure_liege_title = title:e_castamir
			}
		}
		else_if = {
			limit = {
				OR = {
					primary_title = {
						OR = {
							de_jure_liege = title:e_numenor_in_exile
							de_jure_liege.de_jure_liege = title:e_numenor_in_exile
							de_jure_liege.de_jure_liege.de_jure_liege = title:e_numenor_in_exile
						}
					}
					has_title = title:e_numenor_in_exile
				}
			}
			title:k_mirlond = {
				set_de_jure_liege_title = title:e_numenor_in_exile
			}
		}
		#else_if = {	#juke note: Maybe someday...
		#	limit = {
		#		OR = {
		#			primary_title = {
		#				OR = {
		#					de_jure_liege = title:e_numenor
		#					de_jure_liege.de_jure_liege = title:e_numenor
		#					de_jure_liege.de_jure_liege.de_jure_liege = title:e_numenor
		#				}
		#			}
		#			has_title = title:e_numenor
		#		}
		#	}
		#	title:k_mirlond = {
		#			set_de_jure_liege_title = title:e_numenor
		#	}
		#}
		else_if = {
			title:k_mirlond = {
				set_de_jure_liege_title = title:e_umbar
			}	
		}
		custom_tooltip = harnen_kingdom_decision
	}
}

decision_castamir_claim = {
	title = decision_castamir_claim
	picture = "gfx/interface/illustrations/decisions/decision_destiny_goal.dds"
	major = yes
	ai_goal = yes
	ai_potential = {
		always = yes
	}
	ai_will_do = {
		base = 100
		modifier = { # AI will not attempt unless Gondor is weaker
			factor = 0
			exists = title:e_gondor.holder
			root.total_strength < title:e_gondor.holder.total_strength
		}
		modifier = {
			factor = 0
			exists = title:e_gondor_steward.holder
			root.total_strength < title:e_gondor_steward.holder.total_strength
		}
	}
	selection_tooltip = decision_castamir_claim_tooltip
	desc = decision_castamir_claim_desc
	confirm_text = decision_castamir_claim_confirm
	
	is_shown = {
		is_ruler = yes
		is_landed = yes
		dynasty = dynasty:dynasty_castamir
		has_title = title:k_umbar
		OR = {
			exists = title:e_gondor
			exists = title:e_gondor_steward
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:decision_castamir_claim
			}
		}
		NOR = {	#juke note: we want to account for gondor potentially being held by a castamiri already
			AND = {
				exists = title:e_gondor.holder
				title:e_gondor.holder = {
					dynasty = dynasty:dynasty_castamir
				}
			}
			AND = {
				exists = title:e_gondor_steward.holder
				title:e_gondor_steward.holder = {
					dynasty = dynasty:dynasty_castamir
				}
			}
		}
	}
	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
		is_at_war = no
		NOR = {
			AND = {
				exists = title:e_gondor_steward.holder
				has_truce = title:e_gondor_steward.holder
			}
			AND = {	
				exists = title:e_gondor.holder
				has_truce = title:e_gondor.holder
			}			
		}
	}
	is_valid = {
		is_independent_ruler = yes
		dynasty = dynasty:dynasty_castamir
		completely_controls = title:k_umbar
		prestige_level >= very_high_prestige_level
		has_title = title:e_umbar
	}
	effect = {
		custom_tooltip = press_castamiri_claim_tooltip
		save_scope_as = claimant
		character:lineofanarion53 = { save_scope_as = castamir }
		character:lineofanarion27 = { save_scope_as = eldacar }
		if = {
			limit = { # Minor News
				has_game_rule = all_news
			}
			every_player = { #Global News Announcement
				trigger_event = news_event.0012
			}
		}
		trigger_event = {
			id = umbar.1000
		}
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:decision_castamir_claim
		
		}
	}
}
#
#decision_wildmen_invasion_gondor = {
#	title = decision_wildman_invasion_t
#	picture = "gfx/interface/illustrations/decisions/fp1_decision_forge_jomsvikings.dds"
#	major = yes
#	ai_goal = yes
#	ai_potential = { always = yes }
#	ai_will_do = { base = 100 }
#	selection_tooltip = decision_wildman_invasion_tooltip
#	desc = decision_wildman_invasion_desc
#	confirm_text = decision_wildman_invasion_confirm
#	is_shown = {
#		is_ruler = yes
#		is_landed = yes
#		dynasty = dynasty:dynasty_castamir
#		has_title = title:k_umbar
#		has_character_modifier = black_lord_of_umbar_modifier
#		NOT = {
#				is_target_in_global_variable_list = {
#				name = unavailable_unique_decisions
#				target = flag:decision_wildmen_invasion_gondor
#				}
#		}
#		
#	}
#	is_valid_showing_failures_only = {
#		title:d_nan_i_feryn.holder = {
#			is_at_war = no
#		}
#	}
#	is_valid = {
#		is_independent_ruler = yes
#		has_title = title:k_umbar
#		dynasty = dynasty:dynasty_castamir
#
#	}
#	cost = {
#		gold = 350
#	}
#	effect = {
#		custom_tooltip = decision_wildman_invasion_tooltip
#		custom_tooltip = decision_wildman_invasion_tooltip_2
#		title:k_umbar.holder = { save_scope_as = black_lord }
#		hidden_effect = {
#			#We prefer to use actual characters, but if there aren't any, we try to generate a fallback.
#			##Populate Western list backup.
#			if = {
#				limit = {
#					NOT = {
#						any_in_global_list = {
#							variable = western_scandinavian_adventurer_list
#							count >= 1
#							valid_scandinavian_adventurer = yes
#						}
#					}
#					any_county_in_region = {
#						region = dlc_fp1_region_lotr_western_pool
#						lotr_wildpeople_trigger = yes
#					}
#				}
#				random_county_in_region = {
#					region = dlc_fp1_region_lotr_western_pool
#					limit = { lotr_wildpeople_trigger = yes }
#					save_scope_as = scandinavian_county
#				}
#				create_character = {
#					location = scope:scandinavian_county.title_province
#					template = fp1_western_warrior_character
#					save_scope_as = backup_adventurer
#				}
#				scope:backup_adventurer = {
#					add_to_global_variable_list = {
#						name = western_scandinavian_adventurer_list
#						target = this
#					}
#					add_character_modifier = agent_of_corsairs
#				}
#				add_courtier = scope:backup_adventurer # Matt note: This lets the player keep tabs on them.
#			}
#		}
#		trigger_event = {
#			id = fp1_scandinavian_adventurers.0002
#			days = { 1 10 }
#		}
#		add_to_global_variable_list = {
#			name = unavailable_unique_decisions
#			target = flag:decision_wildmen_invasion_gondor
#		}
#	}
#}